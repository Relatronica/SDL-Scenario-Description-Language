import{i as je,r as Y,g as Zi,R as X,c as tr,a as nr,b as qi,p as Ki,v as Qi,j as Q}from"./index-C0v0yw9o.js";var rr=180/Math.PI,bn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Br(e,t,n,r,o,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:o,translateY:s,rotate:Math.atan2(t,e)*rr,skewX:Math.atan(c)*rr,scaleX:i,scaleY:a}}var Ot;function Ji(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?bn:Br(t.a,t.b,t.c,t.d,t.e,t.f)}function es(e){return e==null||(Ot||(Ot=document.createElementNS("http://www.w3.org/2000/svg","g")),Ot.setAttribute("transform",e),!(e=Ot.transform.baseVal.consolidate()))?bn:(e=e.matrix,Br(e.a,e.b,e.c,e.d,e.e,e.f))}function jr(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function s(u,l,d,g,f,v){if(u!==d||l!==g){var w=f.push("translate(",null,t,null,n);v.push({i:w-4,x:je(u,d)},{i:w-2,x:je(l,g)})}else(d||g)&&f.push("translate("+d+t+g+n)}function i(u,l,d,g){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),g.push({i:d.push(o(d)+"rotate(",null,r)-2,x:je(u,l)})):l&&d.push(o(d)+"rotate("+l+r)}function a(u,l,d,g){u!==l?g.push({i:d.push(o(d)+"skewX(",null,r)-2,x:je(u,l)}):l&&d.push(o(d)+"skewX("+l+r)}function c(u,l,d,g,f,v){if(u!==d||l!==g){var w=f.push(o(f)+"scale(",null,",",null,")");v.push({i:w-4,x:je(u,d)},{i:w-2,x:je(l,g)})}else(d!==1||g!==1)&&f.push(o(f)+"scale("+d+","+g+")")}return function(u,l){var d=[],g=[];return u=e(u),l=e(l),s(u.translateX,u.translateY,l.translateX,l.translateY,d,g),i(u.rotate,l.rotate,d,g),a(u.skewX,l.skewX,d,g),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,d,g),u=l=null,function(f){for(var v=-1,w=g.length,C;++v<w;)d[(C=g[v]).i]=C.x(f);return d.join("")}}}var ts=jr(Ji,"px, ","px)","deg)"),ns=jr(es,", ",")",")"),rs=1e-12;function or(e){return((e=Math.exp(e))+1/e)/2}function os(e){return((e=Math.exp(e))-1/e)/2}function is(e){return((e=Math.exp(2*e))-1)/(e+1)}const ss=function e(t,n,r){function o(s,i){var a=s[0],c=s[1],u=s[2],l=i[0],d=i[1],g=i[2],f=l-a,v=d-c,w=f*f+v*v,C,_;if(w<rs)_=Math.log(g/u)/t,C=function(V){return[a+V*f,c+V*v,u*Math.exp(t*V*_)]};else{var x=Math.sqrt(w),I=(g*g-u*u+r*w)/(2*u*n*x),m=(g*g-u*u-r*w)/(2*g*n*x),$=Math.log(Math.sqrt(I*I+1)-I),z=Math.log(Math.sqrt(m*m+1)-m);_=(z-$)/t,C=function(V){var H=V*_,B=or($),S=u/(n*x)*(B*is(t*H+$)-os($));return[a+S*f,c+S*v,u*B/or(t*H+$)]}}return C.duration=_*1e3*t/Math.SQRT2,C}return o.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},o}(Math.SQRT2,2,4);function fe(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=fe(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Yr={exports:{}},Gr={},Xr={exports:{}},Wr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var at=Y;function as(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cs=typeof Object.is=="function"?Object.is:as,ls=at.useState,us=at.useEffect,ds=at.useLayoutEffect,fs=at.useDebugValue;function hs(e,t){var n=t(),r=ls({inst:{value:n,getSnapshot:t}}),o=r[0].inst,s=r[1];return ds(function(){o.value=n,o.getSnapshot=t,fn(o)&&s({inst:o})},[e,n,t]),us(function(){return fn(o)&&s({inst:o}),e(function(){fn(o)&&s({inst:o})})},[e]),fs(n),n}function fn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cs(e,n)}catch{return!0}}function gs(e,t){return t()}var ps=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gs:hs;Wr.useSyncExternalStore=at.useSyncExternalStore!==void 0?at.useSyncExternalStore:ps;Xr.exports=Wr;var ms=Xr.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var en=Y,ys=ms;function vs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ws=typeof Object.is=="function"?Object.is:vs,xs=ys.useSyncExternalStore,bs=en.useRef,Es=en.useEffect,_s=en.useMemo,Ns=en.useDebugValue;Gr.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var s=bs(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=_s(function(){function c(f){if(!u){if(u=!0,l=f,f=r(f),o!==void 0&&i.hasValue){var v=i.value;if(o(v,f))return d=v}return d=f}if(v=d,ws(l,f))return v;var w=r(f);return o!==void 0&&o(v,w)?(l=f,v):(l=f,d=w)}var u=!1,l,d,g=n===void 0?null:n;return[function(){return c(t())},g===null?void 0:function(){return c(g())}]},[t,n,r,o]);var a=xs(e,s[0],s[1]);return Es(function(){i.hasValue=!0,i.value=a},[a]),Ns(a),a};Yr.exports=Gr;var Ss=Yr.exports;const ks=Zi(Ss),Cs={},ir=e=>{let t;const n=new Set,r=(l,d)=>{const g=typeof l=="function"?l(t):l;if(!Object.is(g,t)){const f=t;t=d??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(v=>v(t,f))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(Cs?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,o,c);return c},Ms=e=>e?ir(e):ir,{useDebugValue:Is}=X,{useSyncExternalStoreWithSelector:As}=ks,Ts=e=>e;function Ur(e,t=Ts,n){const r=As(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Is(r),r}const sr=(e,t)=>{const n=Ms(e),r=(o,s=t)=>Ur(n,o,s);return Object.assign(r,n),r},$s=(e,t)=>e?sr(e,t):sr;function de(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Os={value:()=>{}};function tn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ht(n)}function Ht(e){this._=e}function Rs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ht.prototype=tn.prototype={constructor:Ht,on:function(e,t){var n=this._,r=Rs(e+"",n),o,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((o=(e=r[s]).type)&&(o=zs(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(o=(e=r[s]).type)n[o]=ar(n[o],e.name,t);else if(t==null)for(o in n)n[o]=ar(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ht(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,s;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,o=s.length;r<o;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,s=r.length;o<s;++o)r[o].value.apply(t,n)}};function zs(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function ar(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Os,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var En="http://www.w3.org/1999/xhtml";const cr={svg:"http://www.w3.org/2000/svg",xhtml:En,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),cr.hasOwnProperty(t)?{space:cr[t],local:e}:e}function Ds(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===En&&t.documentElement.namespaceURI===En?t.createElement(e):t.createElementNS(n,e)}}function Ps(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Zr(e){var t=nn(e);return(t.local?Ps:Ds)(t)}function Ls(){}function zn(e){return e==null?Ls:function(){return this.querySelector(e)}}function Vs(e){typeof e!="function"&&(e=zn(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=new Array(i),c,u,l=0;l<i;++l)(c=s[l])&&(u=e.call(c,c.__data__,l,s))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new pe(r,this._parents)}function Fs(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Hs(){return[]}function qr(e){return e==null?Hs:function(){return this.querySelectorAll(e)}}function Bs(e){return function(){return Fs(e.apply(this,arguments))}}function js(e){typeof e=="function"?e=Bs(e):e=qr(e);for(var t=this._groups,n=t.length,r=[],o=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,u=0;u<a;++u)(c=i[u])&&(r.push(e.call(c,c.__data__,u,i)),o.push(c));return new pe(r,o)}function Kr(e){return function(){return this.matches(e)}}function Qr(e){return function(t){return t.matches(e)}}var Ys=Array.prototype.find;function Gs(e){return function(){return Ys.call(this.children,e)}}function Xs(){return this.firstElementChild}function Ws(e){return this.select(e==null?Xs:Gs(typeof e=="function"?e:Qr(e)))}var Us=Array.prototype.filter;function Zs(){return Array.from(this.children)}function qs(e){return function(){return Us.call(this.children,e)}}function Ks(e){return this.selectAll(e==null?Zs:qs(typeof e=="function"?e:Qr(e)))}function Qs(e){typeof e!="function"&&(e=Kr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,u=0;u<i;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new pe(r,this._parents)}function Jr(e){return new Array(e.length)}function Js(){return new pe(this._enter||this._groups.map(Jr),this._parents)}function Gt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Gt.prototype={constructor:Gt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ea(e){return function(){return e}}function ta(e,t,n,r,o,s){for(var i=0,a,c=t.length,u=s.length;i<u;++i)(a=t[i])?(a.__data__=s[i],r[i]=a):n[i]=new Gt(e,s[i]);for(;i<c;++i)(a=t[i])&&(o[i]=a)}function na(e,t,n,r,o,s,i){var a,c,u=new Map,l=t.length,d=s.length,g=new Array(l),f;for(a=0;a<l;++a)(c=t[a])&&(g[a]=f=i.call(c,c.__data__,a,t)+"",u.has(f)?o[a]=c:u.set(f,c));for(a=0;a<d;++a)f=i.call(e,s[a],a,s)+"",(c=u.get(f))?(r[a]=c,c.__data__=s[a],u.delete(f)):n[a]=new Gt(e,s[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(g[a])===c&&(o[a]=c)}function ra(e){return e.__data__}function oa(e,t){if(!arguments.length)return Array.from(this,ra);var n=t?na:ta,r=this._parents,o=this._groups;typeof e!="function"&&(e=ea(e));for(var s=o.length,i=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var l=r[u],d=o[u],g=d.length,f=ia(e.call(l,l&&l.__data__,u,r)),v=f.length,w=a[u]=new Array(v),C=i[u]=new Array(v),_=c[u]=new Array(g);n(l,d,w,C,_,f,t);for(var x=0,I=0,m,$;x<v;++x)if(m=w[x]){for(x>=I&&(I=x+1);!($=C[I])&&++I<v;);m._next=$||null}}return i=new pe(i,r),i._enter=a,i._exit=c,i}function ia(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function sa(){return new pe(this._exit||this._groups.map(Jr),this._parents)}function aa(e,t,n){var r=this.enter(),o=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?s.remove():n(s),r&&o?r.merge(o).order():o}function ca(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,s=r.length,i=Math.min(o,s),a=new Array(o),c=0;c<i;++c)for(var u=n[c],l=r[c],d=u.length,g=a[c]=new Array(d),f,v=0;v<d;++v)(f=u[v]||l[v])&&(g[v]=f);for(;c<o;++c)a[c]=n[c];return new pe(a,this._parents)}function la(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,s=r[o],i;--o>=0;)(i=r[o])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function ua(e){e||(e=da);function t(d,g){return d&&g?e(d.__data__,g.__data__):!d-!g}for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s){for(var i=n[s],a=i.length,c=o[s]=new Array(a),u,l=0;l<a;++l)(u=i[l])&&(c[l]=u);c.sort(t)}return new pe(o,this._parents).order()}function da(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function fa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ha(){return Array.from(this)}function ga(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length;o<s;++o){var i=r[o];if(i)return i}return null}function pa(){let e=0;for(const t of this)++e;return e}function ma(){return!this.node()}function ya(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],s=0,i=o.length,a;s<i;++s)(a=o[s])&&e.call(a,a.__data__,s,o);return this}function va(e){return function(){this.removeAttribute(e)}}function wa(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xa(e,t){return function(){this.setAttribute(e,t)}}function ba(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ea(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function _a(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Na(e,t){var n=nn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?wa:va:typeof t=="function"?n.local?_a:Ea:n.local?ba:xa)(n,t))}function eo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Sa(e){return function(){this.style.removeProperty(e)}}function ka(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ca(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ma(e,t,n){return arguments.length>1?this.each((t==null?Sa:typeof t=="function"?Ca:ka)(e,t,n??"")):ct(this.node(),e)}function ct(e,t){return e.style.getPropertyValue(t)||eo(e).getComputedStyle(e,null).getPropertyValue(t)}function Ia(e){return function(){delete this[e]}}function Aa(e,t){return function(){this[e]=t}}function Ta(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function $a(e,t){return arguments.length>1?this.each((t==null?Ia:typeof t=="function"?Ta:Aa)(e,t)):this.node()[e]}function to(e){return e.trim().split(/^|\s+/)}function Dn(e){return e.classList||new no(e)}function no(e){this._node=e,this._names=to(e.getAttribute("class")||"")}no.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ro(e,t){for(var n=Dn(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function oo(e,t){for(var n=Dn(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Oa(e){return function(){ro(this,e)}}function Ra(e){return function(){oo(this,e)}}function za(e,t){return function(){(t.apply(this,arguments)?ro:oo)(this,e)}}function Da(e,t){var n=to(e+"");if(arguments.length<2){for(var r=Dn(this.node()),o=-1,s=n.length;++o<s;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?za:t?Oa:Ra)(n,t))}function Pa(){this.textContent=""}function La(e){return function(){this.textContent=e}}function Va(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Fa(e){return arguments.length?this.each(e==null?Pa:(typeof e=="function"?Va:La)(e)):this.node().textContent}function Ha(){this.innerHTML=""}function Ba(e){return function(){this.innerHTML=e}}function ja(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ya(e){return arguments.length?this.each(e==null?Ha:(typeof e=="function"?ja:Ba)(e)):this.node().innerHTML}function Ga(){this.nextSibling&&this.parentNode.appendChild(this)}function Xa(){return this.each(Ga)}function Wa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ua(){return this.each(Wa)}function Za(e){var t=typeof e=="function"?e:Zr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function qa(){return null}function Ka(e,t){var n=typeof e=="function"?e:Zr(e),r=t==null?qa:typeof t=="function"?t:zn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Qa(){var e=this.parentNode;e&&e.removeChild(this)}function Ja(){return this.each(Qa)}function ec(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nc(e){return this.select(e?tc:ec)}function rc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function oc(e){return function(t){e.call(this,t,this.__data__)}}function ic(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function sc(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,s;n<o;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function ac(e,t,n){return function(){var r=this.__on,o,s=oc(t);if(r){for(var i=0,a=r.length;i<a;++i)if((o=r[i]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=s,o.options=n),o.value=t;return}}this.addEventListener(e.type,s,n),o={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(o):this.__on=[o]}}function cc(e,t,n){var r=ic(e+""),o,s=r.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(o=0,l=a[c];o<s;++o)if((i=r[o]).type===l.type&&i.name===l.name)return l.value}return}for(a=t?ac:sc,o=0;o<s;++o)this.each(a(r[o],t,n));return this}function io(e,t,n){var r=eo(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function lc(e,t){return function(){return io(this,e,t)}}function uc(e,t){return function(){return io(this,e,t.apply(this,arguments))}}function dc(e,t){return this.each((typeof t=="function"?uc:lc)(e,t))}function*fc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,s=r.length,i;o<s;++o)(i=r[o])&&(yield i)}var so=[null];function pe(e,t){this._groups=e,this._parents=t}function Tt(){return new pe([[document.documentElement]],so)}function hc(){return this}pe.prototype=Tt.prototype={constructor:pe,select:Vs,selectAll:js,selectChild:Ws,selectChildren:Ks,filter:Qs,data:oa,enter:Js,exit:sa,join:aa,merge:ca,selection:hc,order:la,sort:ua,call:fa,nodes:ha,node:ga,size:pa,empty:ma,each:ya,attr:Na,style:Ma,property:$a,classed:Da,text:Fa,html:Ya,raise:Xa,lower:Ua,append:Za,insert:Ka,remove:Ja,clone:nc,datum:rc,on:cc,dispatch:dc,[Symbol.iterator]:fc};function me(e){return typeof e=="string"?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],so)}function gc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xe(e,t){if(e=gc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const pc={passive:!1},kt={capture:!0,passive:!1};function hn(e){e.stopImmediatePropagation()}function it(e){e.preventDefault(),e.stopImmediatePropagation()}function ao(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",it,kt);"onselectstart"in t?n.on("selectstart.drag",it,kt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function co(e,t){var n=e.document.documentElement,r=me(e).on("dragstart.drag",null);t&&(r.on("click.drag",it,kt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Rt=e=>()=>e;function _n(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:s,x:i,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}_n.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function mc(e){return!e.ctrlKey&&!e.button}function yc(){return this.parentNode}function vc(e,t){return t??{x:e.x,y:e.y}}function wc(){return navigator.maxTouchPoints||"ontouchstart"in this}function xc(){var e=mc,t=yc,n=vc,r=wc,o={},s=tn("start","drag","end"),i=0,a,c,u,l,d=0;function g(m){m.on("mousedown.drag",f).filter(r).on("touchstart.drag",C).on("touchmove.drag",_,pc).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(m,$){if(!(l||!e.call(this,m,$))){var z=I(this,t.call(this,m,$),m,$,"mouse");z&&(me(m.view).on("mousemove.drag",v,kt).on("mouseup.drag",w,kt),ao(m.view),hn(m),u=!1,a=m.clientX,c=m.clientY,z("start",m))}}function v(m){if(it(m),!u){var $=m.clientX-a,z=m.clientY-c;u=$*$+z*z>d}o.mouse("drag",m)}function w(m){me(m.view).on("mousemove.drag mouseup.drag",null),co(m.view,u),it(m),o.mouse("end",m)}function C(m,$){if(e.call(this,m,$)){var z=m.changedTouches,V=t.call(this,m,$),H=z.length,B,S;for(B=0;B<H;++B)(S=I(this,V,m,$,z[B].identifier,z[B]))&&(hn(m),S("start",m,z[B]))}}function _(m){var $=m.changedTouches,z=$.length,V,H;for(V=0;V<z;++V)(H=o[$[V].identifier])&&(it(m),H("drag",m,$[V]))}function x(m){var $=m.changedTouches,z=$.length,V,H;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),V=0;V<z;++V)(H=o[$[V].identifier])&&(hn(m),H("end",m,$[V]))}function I(m,$,z,V,H,B){var S=s.copy(),A=xe(B||z,$),L,M,h;if((h=n.call(m,new _n("beforestart",{sourceEvent:z,target:g,identifier:H,active:i,x:A[0],y:A[1],dx:0,dy:0,dispatch:S}),V))!=null)return L=h.x-A[0]||0,M=h.y-A[1]||0,function N(y,k,R){var E=A,O;switch(y){case"start":o[H]=N,O=i++;break;case"end":delete o[H],--i;case"drag":A=xe(R||k,$),O=i;break}S.call(y,m,new _n(y,{sourceEvent:k,subject:h,target:g,identifier:H,active:O,x:A[0]+L,y:A[1]+M,dx:A[0]-E[0],dy:A[1]-E[1],dispatch:S}),V)}}return g.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Rt(!!m),g):e},g.container=function(m){return arguments.length?(t=typeof m=="function"?m:Rt(m),g):t},g.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Rt(m),g):n},g.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:Rt(!!m),g):r},g.on=function(){var m=s.on.apply(s,arguments);return m===s?g:m},g.clickDistance=function(m){return arguments.length?(d=(m=+m)*m,g):Math.sqrt(d)},g}var lt=0,Et=0,yt=0,lo=1e3,Xt,_t,Wt=0,We=0,rn=0,Ct=typeof performance=="object"&&performance.now?performance:Date,uo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Pn(){return We||(uo(bc),We=Ct.now()+rn)}function bc(){We=0}function Ut(){this._call=this._time=this._next=null}Ut.prototype=fo.prototype={constructor:Ut,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Pn():+n)+(t==null?0:+t),!this._next&&_t!==this&&(_t?_t._next=this:Xt=this,_t=this),this._call=e,this._time=n,Nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nn())}};function fo(e,t,n){var r=new Ut;return r.restart(e,t,n),r}function Ec(){Pn(),++lt;for(var e=Xt,t;e;)(t=We-e._time)>=0&&e._call.call(void 0,t),e=e._next;--lt}function lr(){We=(Wt=Ct.now())+rn,lt=Et=0;try{Ec()}finally{lt=0,Nc(),We=0}}function _c(){var e=Ct.now(),t=e-Wt;t>lo&&(rn-=t,Wt=e)}function Nc(){for(var e,t=Xt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xt=n);_t=e,Nn(r)}function Nn(e){if(!lt){Et&&(Et=clearTimeout(Et));var t=e-We;t>24?(e<1/0&&(Et=setTimeout(lr,e-Ct.now()-rn)),yt&&(yt=clearInterval(yt))):(yt||(Wt=Ct.now(),yt=setInterval(_c,lo)),lt=1,uo(lr))}}function ur(e,t,n){var r=new Ut;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Sc=tn("start","end","cancel","interrupt"),kc=[],ho=0,dr=1,Sn=2,Bt=3,fr=4,kn=5,jt=6;function on(e,t,n,r,o,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Cc(e,n,{name:t,index:r,group:o,on:Sc,tween:kc,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ho})}function Ln(e,t){var n=Ee(e,t);if(n.state>ho)throw new Error("too late; already scheduled");return n}function Ne(e,t){var n=Ee(e,t);if(n.state>Bt)throw new Error("too late; already running");return n}function Ee(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Cc(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=fo(s,0,n.time);function s(u){n.state=dr,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var l,d,g,f;if(n.state!==dr)return c();for(l in r)if(f=r[l],f.name===n.name){if(f.state===Bt)return ur(i);f.state===fr?(f.state=jt,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=jt,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[l])}if(ur(function(){n.state===Bt&&(n.state=fr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Sn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Sn){for(n.state=Bt,o=new Array(g=n.tween.length),l=0,d=-1;l<g;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=f);o.length=d+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=kn,1),d=-1,g=o.length;++d<g;)o[d].call(e,l);n.state===kn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=jt,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Yt(e,t){var n=e.__transition,r,o,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){s=!1;continue}o=r.state>Sn&&r.state<kn,r.state=jt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}s&&delete e.__transition}}function Mc(e){return this.each(function(){Yt(this,e)})}function Ic(e,t){var n,r;return function(){var o=Ne(this,e),s=o.tween;if(s!==n){r=n=s;for(var i=0,a=r.length;i<a;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function Ac(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var s=Ne(this,e),i=s.tween;if(i!==r){o=(r=i).slice();for(var a={name:t,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===t){o[c]=a;break}c===u&&o.push(a)}s.tween=o}}function Tc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ee(this.node(),n).tween,o=0,s=r.length,i;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((t==null?Ic:Ac)(n,e,t))}function Vn(e,t,n){var r=e._id;return e.each(function(){var o=Ne(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return Ee(o,r).value[t]}}function go(e,t){var n;return(typeof t=="number"?je:t instanceof tr?nr:(n=tr(t))?(t=n,nr):qi)(e,t)}function $c(e){return function(){this.removeAttribute(e)}}function Oc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Rc(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttribute(e);return i===o?null:i===r?s:s=t(r=i,n)}}function zc(e,t,n){var r,o=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?s:s=t(r=i,n)}}function Dc(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Pc(e,t,n){var r,o,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a)))}}function Lc(e,t){var n=nn(e),r=n==="transform"?ns:go;return this.attrTween(e,typeof t=="function"?(n.local?Pc:Dc)(n,r,Vn(this,"attr."+e,t)):t==null?(n.local?Oc:$c)(n):(n.local?zc:Rc)(n,r,t))}function Vc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Fc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Hc(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Fc(e,s)),n}return o._value=t,o}function Bc(e,t){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&Vc(e,s)),n}return o._value=t,o}function jc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=nn(e);return this.tween(n,(r.local?Hc:Bc)(r,t))}function Yc(e,t){return function(){Ln(this,e).delay=+t.apply(this,arguments)}}function Gc(e,t){return t=+t,function(){Ln(this,e).delay=t}}function Xc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yc:Gc)(t,e)):Ee(this.node(),t).delay}function Wc(e,t){return function(){Ne(this,e).duration=+t.apply(this,arguments)}}function Uc(e,t){return t=+t,function(){Ne(this,e).duration=t}}function Zc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wc:Uc)(t,e)):Ee(this.node(),t).duration}function qc(e,t){if(typeof t!="function")throw new Error;return function(){Ne(this,e).ease=t}}function Kc(e){var t=this._id;return arguments.length?this.each(qc(t,e)):Ee(this.node(),t).ease}function Qc(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ne(this,e).ease=n}}function Jc(e){if(typeof e!="function")throw new Error;return this.each(Qc(this._id,e))}function el(e){typeof e!="function"&&(e=Kr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var s=t[o],i=s.length,a=r[o]=[],c,u=0;u<i;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new Te(r,this._parents,this._name,this._id)}function tl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,s=Math.min(r,o),i=new Array(r),a=0;a<s;++a)for(var c=t[a],u=n[a],l=c.length,d=i[a]=new Array(l),g,f=0;f<l;++f)(g=c[f]||u[f])&&(d[f]=g);for(;a<r;++a)i[a]=t[a];return new Te(i,this._parents,this._name,this._id)}function nl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function rl(e,t,n){var r,o,s=nl(t)?Ln:Ne;return function(){var i=s(this,e),a=i.on;a!==r&&(o=(r=a).copy()).on(t,n),i.on=o}}function ol(e,t){var n=this._id;return arguments.length<2?Ee(this.node(),n).on.on(e):this.each(rl(n,e,t))}function il(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function sl(){return this.on("end.remove",il(this._id))}function al(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zn(e));for(var r=this._groups,o=r.length,s=new Array(o),i=0;i<o;++i)for(var a=r[i],c=a.length,u=s[i]=new Array(c),l,d,g=0;g<c;++g)(l=a[g])&&(d=e.call(l,l.__data__,g,a))&&("__data__"in l&&(d.__data__=l.__data__),u[g]=d,on(u[g],t,n,g,u,Ee(l,n)));return new Te(s,this._parents,t,n)}function cl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=qr(e));for(var r=this._groups,o=r.length,s=[],i=[],a=0;a<o;++a)for(var c=r[a],u=c.length,l,d=0;d<u;++d)if(l=c[d]){for(var g=e.call(l,l.__data__,d,c),f,v=Ee(l,n),w=0,C=g.length;w<C;++w)(f=g[w])&&on(f,t,n,w,g,v);s.push(g),i.push(l)}return new Te(s,i,t,n)}var ll=Tt.prototype.constructor;function ul(){return new ll(this._groups,this._parents)}function dl(e,t){var n,r,o;return function(){var s=ct(this,e),i=(this.style.removeProperty(e),ct(this,e));return s===i?null:s===n&&i===r?o:o=t(n=s,r=i)}}function po(e){return function(){this.style.removeProperty(e)}}function fl(e,t,n){var r,o=n+"",s;return function(){var i=ct(this,e);return i===o?null:i===r?s:s=t(r=i,n)}}function hl(e,t,n){var r,o,s;return function(){var i=ct(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ct(this,e))),i===c?null:i===r&&c===o?s:(o=c,s=t(r=i,a))}}function gl(e,t){var n,r,o,s="style."+t,i="end."+s,a;return function(){var c=Ne(this,e),u=c.on,l=c.value[s]==null?a||(a=po(t)):void 0;(u!==n||o!==l)&&(r=(n=u).copy()).on(i,o=l),c.on=r}}function pl(e,t,n){var r=(e+="")=="transform"?ts:go;return t==null?this.styleTween(e,dl(e,r)).on("end.style."+e,po(e)):typeof t=="function"?this.styleTween(e,hl(e,r,Vn(this,"style."+e,t))).each(gl(this._id,e)):this.styleTween(e,fl(e,r,t),n).on("end.style."+e,null)}function ml(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function yl(e,t,n){var r,o;function s(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&ml(e,i,n)),r}return s._value=t,s}function vl(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,yl(e,t,n??""))}function wl(e){return function(){this.textContent=e}}function xl(e){return function(){var t=e(this);this.textContent=t??""}}function bl(e){return this.tween("text",typeof e=="function"?xl(Vn(this,"text",e)):wl(e==null?"":e+""))}function El(e){return function(t){this.textContent=e.call(this,t)}}function _l(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&El(o)),t}return r._value=e,r}function Nl(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,_l(e))}function Sl(){for(var e=this._name,t=this._id,n=mo(),r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,u=0;u<a;++u)if(c=i[u]){var l=Ee(c,t);on(c,e,n,u,i,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Te(r,this._parents,e,n)}function kl(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--o===0&&s()}};n.each(function(){var u=Ne(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),o===0&&s()})}var Cl=0;function Te(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function mo(){return++Cl}var Me=Tt.prototype;Te.prototype={constructor:Te,select:al,selectAll:cl,selectChild:Me.selectChild,selectChildren:Me.selectChildren,filter:el,merge:tl,selection:ul,transition:Sl,call:Me.call,nodes:Me.nodes,node:Me.node,size:Me.size,empty:Me.empty,each:Me.each,on:ol,attr:Lc,attrTween:jc,style:pl,styleTween:vl,text:bl,textTween:Nl,remove:sl,tween:Tc,delay:Xc,duration:Zc,ease:Kc,easeVarying:Jc,end:kl,[Symbol.iterator]:Me[Symbol.iterator]};function Ml(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Il={time:null,delay:0,duration:250,ease:Ml};function Al(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tl(e){var t,n;e instanceof Te?(t=e._id,e=e._name):(t=mo(),(n=Il).time=Pn(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,s=0;s<o;++s)for(var i=r[s],a=i.length,c,u=0;u<a;++u)(c=i[u])&&on(c,e,t,u,i,n||Al(c,t));return new Te(r,this._parents,e,t)}Tt.prototype.interrupt=Mc;Tt.prototype.transition=Tl;const zt=e=>()=>e;function $l(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ie(e,t,n){this.k=e,this.x=t,this.y=n}Ie.prototype={constructor:Ie,scale:function(e){return e===1?this:new Ie(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ie(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ae=new Ie(1,0,0);Ie.prototype;function gn(e){e.stopImmediatePropagation()}function vt(e){e.preventDefault(),e.stopImmediatePropagation()}function Ol(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Rl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function hr(){return this.__zoom||Ae}function zl(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Dl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pl(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function yo(){var e=Ol,t=Rl,n=Pl,r=zl,o=Dl,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=ss,u=tn("start","zoom","end"),l,d,g,f=500,v=150,w=0,C=10;function _(h){h.property("__zoom",hr).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",B).on("dblclick.zoom",S).filter(o).on("touchstart.zoom",A).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(h,N,y,k){var R=h.selection?h.selection():h;R.property("__zoom",hr),h!==R?$(h,N,y,k):R.interrupt().each(function(){z(this,arguments).event(k).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},_.scaleBy=function(h,N,y,k){_.scaleTo(h,function(){var R=this.__zoom.k,E=typeof N=="function"?N.apply(this,arguments):N;return R*E},y,k)},_.scaleTo=function(h,N,y,k){_.transform(h,function(){var R=t.apply(this,arguments),E=this.__zoom,O=y==null?m(R):typeof y=="function"?y.apply(this,arguments):y,D=E.invert(O),F=typeof N=="function"?N.apply(this,arguments):N;return n(I(x(E,F),O,D),R,i)},y,k)},_.translateBy=function(h,N,y,k){_.transform(h,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof y=="function"?y.apply(this,arguments):y),t.apply(this,arguments),i)},null,k)},_.translateTo=function(h,N,y,k,R){_.transform(h,function(){var E=t.apply(this,arguments),O=this.__zoom,D=k==null?m(E):typeof k=="function"?k.apply(this,arguments):k;return n(Ae.translate(D[0],D[1]).scale(O.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof y=="function"?-y.apply(this,arguments):-y),E,i)},k,R)};function x(h,N){return N=Math.max(s[0],Math.min(s[1],N)),N===h.k?h:new Ie(N,h.x,h.y)}function I(h,N,y){var k=N[0]-y[0]*h.k,R=N[1]-y[1]*h.k;return k===h.x&&R===h.y?h:new Ie(h.k,k,R)}function m(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function $(h,N,y,k){h.on("start.zoom",function(){z(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event(k).end()}).tween("zoom",function(){var R=this,E=arguments,O=z(R,E).event(k),D=t.apply(R,E),F=y==null?m(D):typeof y=="function"?y.apply(R,E):y,G=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),b=R.__zoom,p=typeof N=="function"?N.apply(R,E):N,T=c(b.invert(F).concat(G/b.k),p.invert(F).concat(G/p.k));return function(P){if(P===1)P=p;else{var j=T(P),W=G/j[2];P=new Ie(W,F[0]-j[0]*W,F[1]-j[1]*W)}O.zoom(null,P)}})}function z(h,N,y){return!y&&h.__zooming||new V(h,N)}function V(h,N){this.that=h,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(h,N),this.taps=0}V.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,N){return this.mouse&&h!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var N=me(this.that).datum();u.call(h,this.that,new $l(h,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:u}),N)}};function H(h,...N){if(!e.apply(this,arguments))return;var y=z(this,N).event(h),k=this.__zoom,R=Math.max(s[0],Math.min(s[1],k.k*Math.pow(2,r.apply(this,arguments)))),E=xe(h);if(y.wheel)(y.mouse[0][0]!==E[0]||y.mouse[0][1]!==E[1])&&(y.mouse[1]=k.invert(y.mouse[0]=E)),clearTimeout(y.wheel);else{if(k.k===R)return;y.mouse=[E,k.invert(E)],Yt(this),y.start()}vt(h),y.wheel=setTimeout(O,v),y.zoom("mouse",n(I(x(k,R),y.mouse[0],y.mouse[1]),y.extent,i));function O(){y.wheel=null,y.end()}}function B(h,...N){if(g||!e.apply(this,arguments))return;var y=h.currentTarget,k=z(this,N,!0).event(h),R=me(h.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",G,!0),E=xe(h,y),O=h.clientX,D=h.clientY;ao(h.view),gn(h),k.mouse=[E,this.__zoom.invert(E)],Yt(this),k.start();function F(b){if(vt(b),!k.moved){var p=b.clientX-O,T=b.clientY-D;k.moved=p*p+T*T>w}k.event(b).zoom("mouse",n(I(k.that.__zoom,k.mouse[0]=xe(b,y),k.mouse[1]),k.extent,i))}function G(b){R.on("mousemove.zoom mouseup.zoom",null),co(b.view,k.moved),vt(b),k.event(b).end()}}function S(h,...N){if(e.apply(this,arguments)){var y=this.__zoom,k=xe(h.changedTouches?h.changedTouches[0]:h,this),R=y.invert(k),E=y.k*(h.shiftKey?.5:2),O=n(I(x(y,E),k,R),t.apply(this,N),i);vt(h),a>0?me(this).transition().duration(a).call($,O,k,h):me(this).call(_.transform,O,k,h)}}function A(h,...N){if(e.apply(this,arguments)){var y=h.touches,k=y.length,R=z(this,N,h.changedTouches.length===k).event(h),E,O,D,F;for(gn(h),O=0;O<k;++O)D=y[O],F=xe(D,this),F=[F,this.__zoom.invert(F),D.identifier],R.touch0?!R.touch1&&R.touch0[2]!==F[2]&&(R.touch1=F,R.taps=0):(R.touch0=F,E=!0,R.taps=1+!!l);l&&(l=clearTimeout(l)),E&&(R.taps<2&&(d=F[0],l=setTimeout(function(){l=null},f)),Yt(this),R.start())}}function L(h,...N){if(this.__zooming){var y=z(this,N).event(h),k=h.changedTouches,R=k.length,E,O,D,F;for(vt(h),E=0;E<R;++E)O=k[E],D=xe(O,this),y.touch0&&y.touch0[2]===O.identifier?y.touch0[0]=D:y.touch1&&y.touch1[2]===O.identifier&&(y.touch1[0]=D);if(O=y.that.__zoom,y.touch1){var G=y.touch0[0],b=y.touch0[1],p=y.touch1[0],T=y.touch1[1],P=(P=p[0]-G[0])*P+(P=p[1]-G[1])*P,j=(j=T[0]-b[0])*j+(j=T[1]-b[1])*j;O=x(O,Math.sqrt(P/j)),D=[(G[0]+p[0])/2,(G[1]+p[1])/2],F=[(b[0]+T[0])/2,(b[1]+T[1])/2]}else if(y.touch0)D=y.touch0[0],F=y.touch0[1];else return;y.zoom("touch",n(I(O,D,F),y.extent,i))}}function M(h,...N){if(this.__zooming){var y=z(this,N).event(h),k=h.changedTouches,R=k.length,E,O;for(gn(h),g&&clearTimeout(g),g=setTimeout(function(){g=null},f),E=0;E<R;++E)O=k[E],y.touch0&&y.touch0[2]===O.identifier?delete y.touch0:y.touch1&&y.touch1[2]===O.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(O=xe(O,this),Math.hypot(d[0]-O[0],d[1]-O[1])<C)){var D=me(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return _.wheelDelta=function(h){return arguments.length?(r=typeof h=="function"?h:zt(+h),_):r},_.filter=function(h){return arguments.length?(e=typeof h=="function"?h:zt(!!h),_):e},_.touchable=function(h){return arguments.length?(o=typeof h=="function"?h:zt(!!h),_):o},_.extent=function(h){return arguments.length?(t=typeof h=="function"?h:zt([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),_):t},_.scaleExtent=function(h){return arguments.length?(s[0]=+h[0],s[1]=+h[1],_):[s[0],s[1]]},_.translateExtent=function(h){return arguments.length?(i[0][0]=+h[0][0],i[1][0]=+h[1][0],i[0][1]=+h[0][1],i[1][1]=+h[1][1],_):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},_.constrain=function(h){return arguments.length?(n=h,_):n},_.duration=function(h){return arguments.length?(a=+h,_):a},_.interpolate=function(h){return arguments.length?(c=h,_):c},_.on=function(){var h=u.on.apply(u,arguments);return h===u?_:h},_.clickDistance=function(h){return arguments.length?(w=(h=+h)*h,_):Math.sqrt(w)},_.tapDistance=function(h){return arguments.length?(C=+h,_):C},_}const sn=Y.createContext(null),Ll=sn.Provider,$e={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},vo=$e.error001();function ie(e,t){const n=Y.useContext(sn);if(n===null)throw new Error(vo);return Ur(n,e,t)}const ue=()=>{const e=Y.useContext(sn);if(e===null)throw new Error(vo);return Y.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Vl=e=>e.userSelectionActive?"none":"all";function Fn({position:e,children:t,className:n,style:r,...o}){const s=ie(Vl),i=`${e}`.split("-");return X.createElement("div",{className:fe(["react-flow__panel",n,...i]),style:{...r,pointerEvents:s},...o},t)}function Fl({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:X.createElement(Fn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},X.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Hl=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:s={},labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const d=Y.useRef(null),[g,f]=Y.useState({x:0,y:0,width:0,height:0}),v=fe(["react-flow__edge-textwrapper",u]);return Y.useEffect(()=>{if(d.current){const w=d.current.getBBox();f({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),typeof n>"u"||!n?null:X.createElement("g",{transform:`translate(${e-g.width/2} ${t-g.height/2})`,className:v,visibility:g.width?"visible":"hidden",...l},o&&X.createElement("rect",{width:g.width+2*i[0],x:-i[0],y:-i[1],height:g.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),X.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:d,style:r},n),c)};var Bl=Y.memo(Hl);const Hn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ut=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Bn=(e={x:0,y:0},t)=>({x:ut(e.x,t[0][0],t[1][0]),y:ut(e.y,t[0][1],t[1][1])}),gr=(e,t,n)=>e<t?ut(Math.abs(e-t),1,50)/50:e>n?-ut(Math.abs(e-n),1,50)/50:0,wo=(e,t)=>{const n=gr(e.x,35,t.width-35)*20,r=gr(e.y,35,t.height-35)*20;return[n,r]},xo=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},bo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Mt=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Eo=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),pr=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),jl=(e,t)=>Eo(bo(Mt(e),Mt(t))),Cn=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Yl=e=>ye(e.width)&&ye(e.height)&&ye(e.x)&&ye(e.y),ye=e=>!isNaN(e)&&isFinite(e),se=Symbol.for("internals"),_o=["Enter"," ","Escape"],Gl=(e,t)=>{},Xl=e=>"nativeEvent"in e;function Mn(e){var o,s;const t=Xl(e)?e.nativeEvent:e,n=((s=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const No=e=>"clientX"in e,De=(e,t)=>{var s,i;const n=No(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,o=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},Zt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},$t=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:g,interactionWidth:f=20})=>X.createElement(X.Fragment,null,X.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:g}),f&&X.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),o&&ye(n)&&ye(r)?X.createElement(Bl,{x:n,y:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);$t.displayName="BaseEdge";function wt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(s=>s.id===e);o&&n(r,{...o})}}function So({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,s=n<e?n+o:n-o,i=Math.abs(r-t)/2,a=r<t?r+i:r-i;return[s,a,o,i]}function ko({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+o*.375+i*.375+n*.125,u=t*.125+s*.375+a*.375+r*.125,l=Math.abs(c-e),d=Math.abs(u-t);return[c,u,l,d]}var Ue;(function(e){e.Strict="strict",e.Loose="loose"})(Ue||(Ue={}));var Ge;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ge||(Ge={}));var It;(function(e){e.Partial="partial",e.Full="full"})(It||(It={}));var ze;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ze||(ze={}));var qt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(qt||(qt={}));var K;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(K||(K={}));function mr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===K.Left||e===K.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Co({sourceX:e,sourceY:t,sourcePosition:n=K.Bottom,targetX:r,targetY:o,targetPosition:s=K.Top}){const[i,a]=mr({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,u]=mr({pos:s,x1:r,y1:o,x2:e,y2:t}),[l,d,g,f]=ko({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${i},${a} ${c},${u} ${r},${o}`,l,d,g,f]}const jn=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=K.Bottom,targetPosition:s=K.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:v,interactionWidth:w})=>{const[C,_,x]=Co({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:s});return X.createElement($t,{path:C,labelX:_,labelY:x,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:v,interactionWidth:w})});jn.displayName="SimpleBezierEdge";const yr={[K.Left]:{x:-1,y:0},[K.Right]:{x:1,y:0},[K.Top]:{x:0,y:-1},[K.Bottom]:{x:0,y:1}},Wl=({source:e,sourcePosition:t=K.Bottom,target:n})=>t===K.Left||t===K.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},vr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Ul({source:e,sourcePosition:t=K.Bottom,target:n,targetPosition:r=K.Top,center:o,offset:s}){const i=yr[t],a=yr[r],c={x:e.x+i.x*s,y:e.y+i.y*s},u={x:n.x+a.x*s,y:n.y+a.y*s},l=Wl({source:c,sourcePosition:t,target:u}),d=l.x!==0?"x":"y",g=l[d];let f=[],v,w;const C={x:0,y:0},_={x:0,y:0},[x,I,m,$]=So({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[d]*a[d]===-1){v=o.x??x,w=o.y??I;const V=[{x:v,y:c.y},{x:v,y:u.y}],H=[{x:c.x,y:w},{x:u.x,y:w}];i[d]===g?f=d==="x"?V:H:f=d==="x"?H:V}else{const V=[{x:c.x,y:u.y}],H=[{x:u.x,y:c.y}];if(d==="x"?f=i.x===g?H:V:f=i.y===g?V:H,t===r){const M=Math.abs(e[d]-n[d]);if(M<=s){const h=Math.min(s-1,s-M);i[d]===g?C[d]=(c[d]>e[d]?-1:1)*h:_[d]=(u[d]>n[d]?-1:1)*h}}if(t!==r){const M=d==="x"?"y":"x",h=i[d]===a[M],N=c[M]>u[M],y=c[M]<u[M];(i[d]===1&&(!h&&N||h&&y)||i[d]!==1&&(!h&&y||h&&N))&&(f=d==="x"?V:H)}const B={x:c.x+C.x,y:c.y+C.y},S={x:u.x+_.x,y:u.y+_.y},A=Math.max(Math.abs(B.x-f[0].x),Math.abs(S.x-f[0].x)),L=Math.max(Math.abs(B.y-f[0].y),Math.abs(S.y-f[0].y));A>=L?(v=(B.x+S.x)/2,w=f[0].y):(v=f[0].x,w=(B.y+S.y)/2)}return[[e,{x:c.x+C.x,y:c.y+C.y},...f,{x:u.x+_.x,y:u.y+_.y},n],v,w,m,$]}function Zl(e,t,n,r){const o=Math.min(vr(e,t)/2,vr(t,n)/2,r),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${s+o*u},${i}Q ${s},${i} ${s},${i+o*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+o*c}Q ${s},${i} ${s+o*a},${i}`}function In({sourceX:e,sourceY:t,sourcePosition:n=K.Bottom,targetX:r,targetY:o,targetPosition:s=K.Top,borderRadius:i=5,centerX:a,centerY:c,offset:u=20}){const[l,d,g,f,v]=Ul({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:s,center:{x:a,y:c},offset:u});return[l.reduce((C,_,x)=>{let I="";return x>0&&x<l.length-1?I=Zl(l[x-1],_,l[x+1],i):I=`${x===0?"M":"L"}${_.x} ${_.y}`,C+=I,C},""),d,g,f,v]}const an=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:d=K.Bottom,targetPosition:g=K.Top,markerEnd:f,markerStart:v,pathOptions:w,interactionWidth:C})=>{const[_,x,I]=In({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:g,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset});return X.createElement($t,{path:_,labelX:x,labelY:I,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:v,interactionWidth:C})});an.displayName="SmoothStepEdge";const Yn=Y.memo(e=>{var t;return X.createElement(an,{...e,pathOptions:Y.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Yn.displayName="StepEdge";function ql({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,s,i,a]=So({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,s,i,a]}const Gn=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:g,interactionWidth:f})=>{const[v,w,C]=ql({sourceX:e,sourceY:t,targetX:n,targetY:r});return X.createElement($t,{path:v,labelX:w,labelY:C,label:o,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:g,interactionWidth:f})});Gn.displayName="StraightEdge";function Dt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function wr({pos:e,x1:t,y1:n,x2:r,y2:o,c:s}){switch(e){case K.Left:return[t-Dt(t-r,s),n];case K.Right:return[t+Dt(r-t,s),n];case K.Top:return[t,n-Dt(n-o,s)];case K.Bottom:return[t,n+Dt(o-n,s)]}}function Mo({sourceX:e,sourceY:t,sourcePosition:n=K.Bottom,targetX:r,targetY:o,targetPosition:s=K.Top,curvature:i=.25}){const[a,c]=wr({pos:n,x1:e,y1:t,x2:r,y2:o,c:i}),[u,l]=wr({pos:s,x1:r,y1:o,x2:e,y2:t,c:i}),[d,g,f,v]=ko({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${r},${o}`,d,g,f,v]}const Kt=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=K.Bottom,targetPosition:s=K.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:v,pathOptions:w,interactionWidth:C})=>{const[_,x,I]=Mo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:s,curvature:w==null?void 0:w.curvature});return X.createElement($t,{path:_,labelX:x,labelY:I,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:v,interactionWidth:C})});Kt.displayName="BezierEdge";const Xn=Y.createContext(null),Kl=Xn.Provider;Xn.Consumer;const Ql=()=>Y.useContext(Xn),Jl=e=>"id"in e&&"source"in e&&"target"in e,eu=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,An=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,tu=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),nu=(e,t)=>{if(!e.source||!e.target)return t;let n;return Jl(e)?n={...e}:n={...e,id:eu(e)},tu(n,t)?t:t.concat(n)},Tn=({x:e,y:t},[n,r,o],s,[i,a])=>{const c={x:(e-n)/o,y:(t-r)/o};return s?{x:i*Math.round(c.x/i),y:a*Math.round(c.y/a)}:c},Io=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Xe=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},cn=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:s,y:i}=Xe(o,t).positionAbsolute;return bo(r,Mt({x:s,y:i,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Eo(n)},Ao=(e,t,[n,r,o]=[0,0,1],s=!1,i=!1,a=[0,0])=>{const c={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(l=>{const{width:d,height:g,selectable:f=!0,hidden:v=!1}=l;if(i&&!f||v)return!1;const{positionAbsolute:w}=Xe(l,a),C={x:w.x,y:w.y,width:d||0,height:g||0},_=Cn(c,C),x=typeof d>"u"||typeof g>"u"||d===null||g===null,I=s&&_>0,m=(d||0)*(g||0);(x||I||_>=m||l.dragging)&&u.push(l)}),u},To=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},$o=(e,t,n,r,o,s=.1)=>{const i=t/(e.width*(1+s)),a=n/(e.height*(1+s)),c=Math.min(i,a),u=ut(c,r,o),l=e.x+e.width/2,d=e.y+e.height/2,g=t/2-l*u,f=n/2-d*u;return{x:g,y:f,zoom:u}},Ye=(e,t=0)=>e.transition().duration(t);function xr(e,t,n,r){return(t[n]||[]).reduce((o,s)=>{var i,a;return`${e.id}-${s.id}-${n}`!==r&&o.push({id:s.id||null,type:n,nodeId:e.id,x:(((i=e.positionAbsolute)==null?void 0:i.x)??0)+s.x+s.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),o},[])}function ru(e,t,n,r,o,s){const{x:i,y:a}=De(e),u=t.elementsFromPoint(i,a).find(v=>v.classList.contains("react-flow__handle"));if(u){const v=u.getAttribute("data-nodeid");if(v){const w=Wn(void 0,u),C=u.getAttribute("data-handleid"),_=s({nodeId:v,id:C,type:w});if(_){const x=o.find(I=>I.nodeId===v&&I.type===w&&I.id===C);return{handle:{id:C,type:w,nodeId:v,x:(x==null?void 0:x.x)||n.x,y:(x==null?void 0:x.y)||n.y},validHandleResult:_}}}}let l=[],d=1/0;if(o.forEach(v=>{const w=Math.sqrt((v.x-n.x)**2+(v.y-n.y)**2);if(w<=r){const C=s(v);w<=d&&(w<d?l=[{handle:v,validHandleResult:C}]:w===d&&l.push({handle:v,validHandleResult:C}),d=w)}}),!l.length)return{handle:null,validHandleResult:Oo()};if(l.length===1)return l[0];const g=l.some(({validHandleResult:v})=>v.isValid),f=l.some(({handle:v})=>v.type==="target");return l.find(({handle:v,validHandleResult:w})=>f?v.type==="target":g?w.isValid:!0)||l[0]}const ou={source:null,target:null,sourceHandle:null,targetHandle:null},Oo=()=>({handleDomNode:null,isValid:!1,connection:ou,endHandle:null});function Ro(e,t,n,r,o,s,i){const a=o==="target",c=i.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Oo(),handleDomNode:c};if(c){const l=Wn(void 0,c),d=c.getAttribute("data-nodeid"),g=c.getAttribute("data-handleid"),f=c.classList.contains("connectable"),v=c.classList.contains("connectableend"),w={source:a?d:n,sourceHandle:a?g:r,target:a?n:d,targetHandle:a?r:g};u.connection=w,f&&v&&(t===Ue.Strict?a&&l==="source"||!a&&l==="target":d!==n||g!==r)&&(u.endHandle={nodeId:d,handleId:g,type:l},u.isValid=s(w))}return u}function iu({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,s)=>{if(s[se]){const{handleBounds:i}=s[se];let a=[],c=[];i&&(a=xr(s,i,"source",`${t}-${n}-${r}`),c=xr(s,i,"target",`${t}-${n}-${r}`)),o.push(...a,...c)}return o},[])}function Wn(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function pn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function su(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function zo({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:s,setState:i,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=xo(e.target),{connectionMode:d,domNode:g,autoPanOnConnect:f,connectionRadius:v,onConnectStart:w,panBy:C,getNodes:_,cancelConnection:x}=s();let I=0,m;const{x:$,y:z}=De(e),V=l==null?void 0:l.elementFromPoint($,z),H=Wn(c,V),B=g==null?void 0:g.getBoundingClientRect();if(!B||!H)return;let S,A=De(e,B),L=!1,M=null,h=!1,N=null;const y=iu({nodes:_(),nodeId:n,handleId:t,handleType:H}),k=()=>{if(!f)return;const[O,D]=wo(A,B);C({x:O,y:D}),I=requestAnimationFrame(k)};i({connectionPosition:A,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:H,connectionStartHandle:{nodeId:n,handleId:t,type:H},connectionEndHandle:null}),w==null||w(e,{nodeId:n,handleId:t,handleType:H});function R(O){const{transform:D}=s();A=De(O,B);const{handle:F,validHandleResult:G}=ru(O,l,Tn(A,D,!1,[1,1]),v,y,b=>Ro(b,d,n,t,o?"target":"source",a,l));if(m=F,L||(k(),L=!0),N=G.handleDomNode,M=G.connection,h=G.isValid,i({connectionPosition:m&&h?Io({x:m.x,y:m.y},D):A,connectionStatus:su(!!m,h),connectionEndHandle:G.endHandle}),!m&&!h&&!N)return pn(S);M.source!==M.target&&N&&(pn(S),S=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",h),N.classList.toggle("react-flow__handle-valid",h))}function E(O){var D,F;(m||N)&&M&&h&&(r==null||r(M)),(F=(D=s()).onConnectEnd)==null||F.call(D,O),c&&(u==null||u(O)),pn(S),x(),cancelAnimationFrame(I),L=!1,h=!1,M=null,N=null,l.removeEventListener("mousemove",R),l.removeEventListener("mouseup",E),l.removeEventListener("touchmove",R),l.removeEventListener("touchend",E)}l.addEventListener("mousemove",R),l.addEventListener("mouseup",E),l.addEventListener("touchmove",R),l.addEventListener("touchend",E)}const br=()=>!0,au=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),cu=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:s,connectionClickStartHandle:i}=r;return{connecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n}},Do=Y.forwardRef(({type:e="source",position:t=K.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:d,...g},f)=>{var B,S;const v=i||null,w=e==="target",C=ue(),_=Ql(),{connectOnClick:x,noPanClassName:I}=ie(au,de),{connecting:m,clickConnecting:$}=ie(cu(_,v,e),de);_||(S=(B=C.getState()).onError)==null||S.call(B,"010",$e.error010());const z=A=>{const{defaultEdgeOptions:L,onConnect:M,hasDefaultEdges:h}=C.getState(),N={...L,...A};if(h){const{edges:y,setEdges:k}=C.getState();k(nu(N,y))}M==null||M(N),a==null||a(N)},V=A=>{if(!_)return;const L=No(A);o&&(L&&A.button===0||!L)&&zo({event:A,handleId:v,nodeId:_,onConnect:z,isTarget:w,getState:C.getState,setState:C.setState,isValidConnection:n||C.getState().isValidConnection||br}),L?l==null||l(A):d==null||d(A)},H=A=>{const{onClickConnectStart:L,onClickConnectEnd:M,connectionClickStartHandle:h,connectionMode:N,isValidConnection:y}=C.getState();if(!_||!h&&!o)return;if(!h){L==null||L(A,{nodeId:_,handleId:v,handleType:e}),C.setState({connectionClickStartHandle:{nodeId:_,type:e,handleId:v}});return}const k=xo(A.target),R=n||y||br,{connection:E,isValid:O}=Ro({nodeId:_,id:v,type:e},N,h.nodeId,h.handleId||null,h.type,R,k);O&&z(E),M==null||M(A),C.setState({connectionClickStartHandle:null})};return X.createElement("div",{"data-handleid":v,"data-nodeid":_,"data-handlepos":t,"data-id":`${_}-${v}-${e}`,className:fe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",I,u,{source:!w,target:w,connectable:r,connectablestart:o,connectableend:s,connecting:$,connectionindicator:r&&(o&&!m||s&&m)}]),onMouseDown:V,onTouchStart:V,onClick:x?H:void 0,ref:f,...g},c)});Do.displayName="Handle";var dt=Y.memo(Do);const Po=({data:e,isConnectable:t,targetPosition:n=K.Top,sourcePosition:r=K.Bottom})=>X.createElement(X.Fragment,null,X.createElement(dt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,X.createElement(dt,{type:"source",position:r,isConnectable:t}));Po.displayName="DefaultNode";var $n=Y.memo(Po);const Lo=({data:e,isConnectable:t,sourcePosition:n=K.Bottom})=>X.createElement(X.Fragment,null,e==null?void 0:e.label,X.createElement(dt,{type:"source",position:n,isConnectable:t}));Lo.displayName="InputNode";var Vo=Y.memo(Lo);const Fo=({data:e,isConnectable:t,targetPosition:n=K.Top})=>X.createElement(X.Fragment,null,X.createElement(dt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Fo.displayName="OutputNode";var Ho=Y.memo(Fo);const Un=()=>null;Un.displayName="GroupNode";const lu=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Pt=e=>e.id;function uu(e,t){return de(e.selectedNodes.map(Pt),t.selectedNodes.map(Pt))&&de(e.selectedEdges.map(Pt),t.selectedEdges.map(Pt))}const Bo=Y.memo(({onSelectionChange:e})=>{const t=ue(),{selectedNodes:n,selectedEdges:r}=ie(lu,uu);return Y.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChange.forEach(s=>s(o))},[n,r,e]),null});Bo.displayName="SelectionListener";const du=e=>!!e.onSelectionChange;function fu({onSelectionChange:e}){const t=ie(du);return e||t?X.createElement(Bo,{onSelectionChange:e}):null}const hu=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function et(e,t){Y.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function ee(e,t,n){Y.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const gu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:s,onConnectEnd:i,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:d,edgesFocusable:g,edgesUpdatable:f,elevateNodesOnSelect:v,minZoom:w,maxZoom:C,nodeExtent:_,onNodesChange:x,onEdgesChange:I,elementsSelectable:m,connectionMode:$,snapGrid:z,snapToGrid:V,translateExtent:H,connectOnClick:B,defaultEdgeOptions:S,fitView:A,fitViewOptions:L,onNodesDelete:M,onEdgesDelete:h,onNodeDrag:N,onNodeDragStart:y,onNodeDragStop:k,onSelectionDrag:R,onSelectionDragStart:E,onSelectionDragStop:O,noPanClassName:D,nodeOrigin:F,rfId:G,autoPanOnConnect:b,autoPanOnNodeDrag:p,onError:T,connectionRadius:P,isValidConnection:j,nodeDragThreshold:W})=>{const{setNodes:U,setEdges:Z,setDefaultNodesAndEdges:J,setMinZoom:ae,setMaxZoom:re,setTranslateExtent:te,setNodeExtent:le,reset:ne}=ie(hu,de),q=ue();return Y.useEffect(()=>{const ge=r==null?void 0:r.map(Se=>({...Se,...S}));return J(n,ge),()=>{ne()}},[]),ee("defaultEdgeOptions",S,q.setState),ee("connectionMode",$,q.setState),ee("onConnect",o,q.setState),ee("onConnectStart",s,q.setState),ee("onConnectEnd",i,q.setState),ee("onClickConnectStart",a,q.setState),ee("onClickConnectEnd",c,q.setState),ee("nodesDraggable",u,q.setState),ee("nodesConnectable",l,q.setState),ee("nodesFocusable",d,q.setState),ee("edgesFocusable",g,q.setState),ee("edgesUpdatable",f,q.setState),ee("elementsSelectable",m,q.setState),ee("elevateNodesOnSelect",v,q.setState),ee("snapToGrid",V,q.setState),ee("snapGrid",z,q.setState),ee("onNodesChange",x,q.setState),ee("onEdgesChange",I,q.setState),ee("connectOnClick",B,q.setState),ee("fitViewOnInit",A,q.setState),ee("fitViewOnInitOptions",L,q.setState),ee("onNodesDelete",M,q.setState),ee("onEdgesDelete",h,q.setState),ee("onNodeDrag",N,q.setState),ee("onNodeDragStart",y,q.setState),ee("onNodeDragStop",k,q.setState),ee("onSelectionDrag",R,q.setState),ee("onSelectionDragStart",E,q.setState),ee("onSelectionDragStop",O,q.setState),ee("noPanClassName",D,q.setState),ee("nodeOrigin",F,q.setState),ee("rfId",G,q.setState),ee("autoPanOnConnect",b,q.setState),ee("autoPanOnNodeDrag",p,q.setState),ee("onError",T,q.setState),ee("connectionRadius",P,q.setState),ee("isValidConnection",j,q.setState),ee("nodeDragThreshold",W,q.setState),et(e,U),et(t,Z),et(w,ae),et(C,re),et(H,te),et(_,le),null},Er={display:"none"},pu={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},jo="react-flow__node-desc",Yo="react-flow__edge-desc",mu="react-flow__aria-live",yu=e=>e.ariaLiveMessage;function vu({rfId:e}){const t=ie(yu);return X.createElement("div",{id:`${mu}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:pu},t)}function wu({rfId:e,disableKeyboardA11y:t}){return X.createElement(X.Fragment,null,X.createElement("div",{id:`${jo}-${e}`,style:Er},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),X.createElement("div",{id:`${Yo}-${e}`,style:Er},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&X.createElement(vu,{rfId:e}))}var At=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=Y.useState(!1),o=Y.useRef(!1),s=Y.useRef(new Set([])),[i,a]=Y.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),l=u.reduce((d,g)=>d.concat(...g),[]);return[u,l]}return[[],[]]},[e]);return Y.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const l=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&Mn(f))return!1;const w=Nr(f.code,a);s.current.add(f[w]),_r(i,s.current,!1)&&(f.preventDefault(),r(!0))},d=f=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Mn(f))return!1;const w=Nr(f.code,a);_r(i,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(f[w]),f.key==="Meta"&&s.current.clear(),o.current=!1},g=()=>{s.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",l),u==null||u.addEventListener("keyup",d),window.addEventListener("blur",g),()=>{u==null||u.removeEventListener("keydown",l),u==null||u.removeEventListener("keyup",d),window.removeEventListener("blur",g)}}},[e,r]),n};function _r(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Nr(e,t){return t.includes(e)?"code":"key"}function Go(e,t,n,r){var a,c;const o=e.parentNode||e.parentId;if(!o)return n;const s=t.get(o),i=Xe(s,r);return Go(s,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((a=s[se])==null?void 0:a.z)??0)>(n.z??0)?((c=s[se])==null?void 0:c.z)??0:n.z??0},r)}function Xo(e,t,n){e.forEach(r=>{var s;const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n!=null&&n[r.id]){const{x:i,y:a,z:c}=Go(r,e,{...r.position,z:((s=r[se])==null?void 0:s.z)??0},t);r.positionAbsolute={x:i,y:a},r[se].z=c,n!=null&&n[r.id]&&(r[se].isParent=!0)}})}function mn(e,t,n,r){const o=new Map,s={},i=r?1e3:0;return e.forEach(a=>{var f;const c=(ye(a.zIndex)?a.zIndex:0)+(a.selected?i:0),u=t.get(a.id),l={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(s[d]=!0);const g=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(l,se,{enumerable:!1,value:{handleBounds:g||(f=u==null?void 0:u[se])==null?void 0:f.handleBounds,z:c}}),o.set(a.id,l)}),Xo(o,n,s),o}function Wo(e,t={}){const{getNodes:n,width:r,height:o,minZoom:s,maxZoom:i,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:d}=e(),g=t.initial&&!u&&l;if(a&&c&&(g||!t.initial)){const v=n().filter(C=>{var x;const _=t.includeHiddenNodes?C.width&&C.height:!C.hidden;return(x=t.nodes)!=null&&x.length?_&&t.nodes.some(I=>I.id===C.id):_}),w=v.every(C=>C.width&&C.height);if(v.length>0&&w){const C=cn(v,d),{x:_,y:x,zoom:I}=$o(C,r,o,t.minZoom??s,t.maxZoom??i,t.padding??.1),m=Ae.translate(_,x).scale(I);return typeof t.duration=="number"&&t.duration>0?a.transform(Ye(c,t.duration),m):a.transform(c,m),!0}}return!1}function xu(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[se]:r[se],selected:n.selected})}),new Map(t)}function bu(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Lt({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:s,onNodesChange:i,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:xu(e,o)}),i==null||i(e)),t!=null&&t.length&&(u&&r({edges:bu(t,s)}),a==null||a(t))}const tt=()=>{},Eu={zoomIn:tt,zoomOut:tt,zoomTo:tt,getZoom:()=>1,setViewport:tt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:tt,fitBounds:tt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},_u=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Nu=()=>{const e=ue(),{d3Zoom:t,d3Selection:n}=ie(_u,de);return Y.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(Ye(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(Ye(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,s)=>t.scaleTo(Ye(n,s==null?void 0:s.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,s)=>{const[i,a,c]=e.getState().transform,u=Ae.translate(o.x??i,o.y??a).scale(o.zoom??c);t.transform(Ye(n,s==null?void 0:s.duration),u)},getViewport:()=>{const[o,s,i]=e.getState().transform;return{x:o,y:s,zoom:i}},fitView:o=>Wo(e.getState,o),setCenter:(o,s,i)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof(i==null?void 0:i.zoom)<"u"?i.zoom:u,d=a/2-o*l,g=c/2-s*l,f=Ae.translate(d,g).scale(l);t.transform(Ye(n,i==null?void 0:i.duration),f)},fitBounds:(o,s)=>{const{width:i,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:d,zoom:g}=$o(o,i,a,c,u,(s==null?void 0:s.padding)??.1),f=Ae.translate(l,d).scale(g);t.transform(Ye(n,s==null?void 0:s.duration),f)},project:o=>{const{transform:s,snapToGrid:i,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Tn(o,s,i,a)},screenToFlowPosition:o=>{const{transform:s,snapToGrid:i,snapGrid:a,domNode:c}=e.getState();if(!c)return o;const{x:u,y:l}=c.getBoundingClientRect(),d={x:o.x-u,y:o.y-l};return Tn(d,s,i,a)},flowToScreenPosition:o=>{const{transform:s,domNode:i}=e.getState();if(!i)return o;const{x:a,y:c}=i.getBoundingClientRect(),u=Io(o,s);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:Eu,[t,n])};function Zn(){const e=Nu(),t=ue(),n=Y.useCallback(()=>t.getState().getNodes().map(w=>({...w})),[]),r=Y.useCallback(w=>t.getState().nodeInternals.get(w),[]),o=Y.useCallback(()=>{const{edges:w=[]}=t.getState();return w.map(C=>({...C}))},[]),s=Y.useCallback(w=>{const{edges:C=[]}=t.getState();return C.find(_=>_.id===w)},[]),i=Y.useCallback(w=>{const{getNodes:C,setNodes:_,hasDefaultNodes:x,onNodesChange:I}=t.getState(),m=C(),$=typeof w=="function"?w(m):w;if(x)_($);else if(I){const z=$.length===0?m.map(V=>({type:"remove",id:V.id})):$.map(V=>({item:V,type:"reset"}));I(z)}},[]),a=Y.useCallback(w=>{const{edges:C=[],setEdges:_,hasDefaultEdges:x,onEdgesChange:I}=t.getState(),m=typeof w=="function"?w(C):w;if(x)_(m);else if(I){const $=m.length===0?C.map(z=>({type:"remove",id:z.id})):m.map(z=>({item:z,type:"reset"}));I($)}},[]),c=Y.useCallback(w=>{const C=Array.isArray(w)?w:[w],{getNodes:_,setNodes:x,hasDefaultNodes:I,onNodesChange:m}=t.getState();if(I){const z=[..._(),...C];x(z)}else if(m){const $=C.map(z=>({item:z,type:"add"}));m($)}},[]),u=Y.useCallback(w=>{const C=Array.isArray(w)?w:[w],{edges:_=[],setEdges:x,hasDefaultEdges:I,onEdgesChange:m}=t.getState();if(I)x([..._,...C]);else if(m){const $=C.map(z=>({item:z,type:"add"}));m($)}},[]),l=Y.useCallback(()=>{const{getNodes:w,edges:C=[],transform:_}=t.getState(),[x,I,m]=_;return{nodes:w().map($=>({...$})),edges:C.map($=>({...$})),viewport:{x,y:I,zoom:m}}},[]),d=Y.useCallback(({nodes:w,edges:C})=>{const{nodeInternals:_,getNodes:x,edges:I,hasDefaultNodes:m,hasDefaultEdges:$,onNodesDelete:z,onEdgesDelete:V,onNodesChange:H,onEdgesChange:B}=t.getState(),S=(w||[]).map(N=>N.id),A=(C||[]).map(N=>N.id),L=x().reduce((N,y)=>{const k=y.parentNode||y.parentId,R=!S.includes(y.id)&&k&&N.find(O=>O.id===k);return(typeof y.deletable=="boolean"?y.deletable:!0)&&(S.includes(y.id)||R)&&N.push(y),N},[]),M=I.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),h=M.filter(N=>A.includes(N.id));if(L||h){const N=To(L,M),y=[...h,...N],k=y.reduce((R,E)=>(R.includes(E.id)||R.push(E.id),R),[]);if(($||m)&&($&&t.setState({edges:I.filter(R=>!k.includes(R.id))}),m&&(L.forEach(R=>{_.delete(R.id)}),t.setState({nodeInternals:new Map(_)}))),k.length>0&&(V==null||V(y),B&&B(k.map(R=>({id:R,type:"remove"})))),L.length>0&&(z==null||z(L),H)){const R=L.map(E=>({id:E.id,type:"remove"}));H(R)}}},[]),g=Y.useCallback(w=>{const C=Yl(w),_=C?null:t.getState().nodeInternals.get(w.id);return!C&&!_?[null,null,C]:[C?w:pr(_),_,C]},[]),f=Y.useCallback((w,C=!0,_)=>{const[x,I,m]=g(w);return x?(_||t.getState().getNodes()).filter($=>{if(!m&&($.id===I.id||!$.positionAbsolute))return!1;const z=pr($),V=Cn(z,x);return C&&V>0||V>=x.width*x.height}):[]},[]),v=Y.useCallback((w,C,_=!0)=>{const[x]=g(w);if(!x)return!1;const I=Cn(x,C);return _&&I>0||I>=x.width*x.height},[]);return Y.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:s,setNodes:i,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:d,getIntersectingNodes:f,isNodeIntersecting:v}),[e,n,r,o,s,i,a,c,u,l,d,f,v])}const Su={actInsideInputWithModifier:!1};var ku=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ue(),{deleteElements:r}=Zn(),o=At(e,Su),s=At(t);Y.useEffect(()=>{if(o){const{edges:i,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=i.filter(l=>l.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),Y.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function Cu(e){const t=ue();Y.useEffect(()=>{let n;const r=()=>{var s,i;if(!e.current)return;const o=Hn(e.current);(o.height===0||o.width===0)&&((i=(s=t.getState()).onError)==null||i.call(s,"004",$e.error004())),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const qn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Mu=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Vt=e=>({x:e.x,y:e.y,zoom:e.k}),nt=(e,t)=>e.target.closest(`.${t}`),Sr=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),kr=e=>{const t=e.ctrlKey&&Zt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Iu=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Au=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:s=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Ge.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:d=!0,defaultViewport:g,translateExtent:f,minZoom:v,maxZoom:w,zoomActivationKeyCode:C,preventScrolling:_=!0,children:x,noWheelClassName:I,noPanClassName:m})=>{const $=Y.useRef(),z=ue(),V=Y.useRef(!1),H=Y.useRef(!1),B=Y.useRef(null),S=Y.useRef({x:0,y:0,zoom:0}),{d3Zoom:A,d3Selection:L,d3ZoomHandler:M,userSelectionActive:h}=ie(Iu,de),N=At(C),y=Y.useRef(0),k=Y.useRef(!1),R=Y.useRef();return Cu(B),Y.useEffect(()=>{if(B.current){const E=B.current.getBoundingClientRect(),O=yo().scaleExtent([v,w]).translateExtent(f),D=me(B.current).call(O),F=Ae.translate(g.x,g.y).scale(ut(g.zoom,v,w)),G=[[0,0],[E.width,E.height]],b=O.constrain()(F,G,f);O.transform(D,b),O.wheelDelta(kr),z.setState({d3Zoom:O,d3Selection:D,d3ZoomHandler:D.on("wheel.zoom"),transform:[b.x,b.y,b.k],domNode:B.current.closest(".react-flow")})}},[]),Y.useEffect(()=>{L&&A&&(i&&!N&&!h?L.on("wheel.zoom",E=>{if(nt(E,I))return!1;E.preventDefault(),E.stopImmediatePropagation();const O=L.property("__zoom").k||1;if(E.ctrlKey&&s){const j=xe(E),W=kr(E),U=O*Math.pow(2,W);A.scaleTo(L,U,j,E);return}const D=E.deltaMode===1?20:1;let F=c===Ge.Vertical?0:E.deltaX*D,G=c===Ge.Horizontal?0:E.deltaY*D;!Zt()&&E.shiftKey&&c!==Ge.Vertical&&(F=E.deltaY*D,G=0),A.translateBy(L,-(F/O)*a,-(G/O)*a,{internal:!0});const b=Vt(L.property("__zoom")),{onViewportChangeStart:p,onViewportChange:T,onViewportChangeEnd:P}=z.getState();clearTimeout(R.current),k.current||(k.current=!0,t==null||t(E,b),p==null||p(b)),k.current&&(e==null||e(E,b),T==null||T(b),R.current=setTimeout(()=>{n==null||n(E,b),P==null||P(b),k.current=!1},150))},{passive:!1}):typeof M<"u"&&L.on("wheel.zoom",function(E,O){if(!_&&E.type==="wheel"&&!E.ctrlKey||nt(E,I))return null;E.preventDefault(),M.call(this,E,O)},{passive:!1}))},[h,i,c,L,A,M,N,s,_,I,t,e,n]),Y.useEffect(()=>{A&&A.on("start",E=>{var F,G;if(!E.sourceEvent||E.sourceEvent.internal)return null;y.current=(F=E.sourceEvent)==null?void 0:F.button;const{onViewportChangeStart:O}=z.getState(),D=Vt(E.transform);V.current=!0,S.current=D,((G=E.sourceEvent)==null?void 0:G.type)==="mousedown"&&z.setState({paneDragging:!0}),O==null||O(D),t==null||t(E.sourceEvent,D)})},[A,t]),Y.useEffect(()=>{A&&(h&&!V.current?A.on("zoom",null):h||A.on("zoom",E=>{var D;const{onViewportChange:O}=z.getState();if(z.setState({transform:[E.transform.x,E.transform.y,E.transform.k]}),H.current=!!(r&&Sr(d,y.current??0)),(e||O)&&!((D=E.sourceEvent)!=null&&D.internal)){const F=Vt(E.transform);O==null||O(F),e==null||e(E.sourceEvent,F)}}))},[h,A,e,d,r]),Y.useEffect(()=>{A&&A.on("end",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;const{onViewportChangeEnd:O}=z.getState();if(V.current=!1,z.setState({paneDragging:!1}),r&&Sr(d,y.current??0)&&!H.current&&r(E.sourceEvent),H.current=!1,(n||O)&&Mu(S.current,E.transform)){const D=Vt(E.transform);S.current=D,clearTimeout($.current),$.current=setTimeout(()=>{O==null||O(D),n==null||n(E.sourceEvent,D)},i?150:0)}})},[A,i,d,n,r]),Y.useEffect(()=>{A&&A.filter(E=>{const O=N||o,D=s&&E.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&E.button===1&&E.type==="mousedown"&&(nt(E,"react-flow__node")||nt(E,"react-flow__edge")))return!0;if(!d&&!O&&!i&&!u&&!s||h||!u&&E.type==="dblclick"||nt(E,I)&&E.type==="wheel"||nt(E,m)&&(E.type!=="wheel"||i&&E.type==="wheel"&&!N)||!s&&E.ctrlKey&&E.type==="wheel"||!O&&!i&&!D&&E.type==="wheel"||!d&&(E.type==="mousedown"||E.type==="touchstart")||Array.isArray(d)&&!d.includes(E.button)&&E.type==="mousedown")return!1;const F=Array.isArray(d)&&d.includes(E.button)||!E.button||E.button<=1;return(!E.ctrlKey||E.type==="wheel")&&F})},[h,A,o,s,i,u,d,l,N]),X.createElement("div",{className:"react-flow__renderer",ref:B,style:qn},x)},Tu=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function $u(){const{userSelectionActive:e,userSelectionRect:t}=ie(Tu,de);return e&&t?X.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Cr(e,t){const n=t.parentNode||t.parentId,r=e.find(o=>o.id===n);if(r){const o=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(o>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,o>0&&(r.style.width+=o),s>0&&(r.style.height+=s),t.position.x<0){const i=Math.abs(t.position.x);r.position.x=r.position.x-i,r.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);r.position.y=r.position.y-i,r.style.height+=i,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Uo(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const s=e.filter(a=>a.id===o.id);if(s.length===0)return r.push(o),r;const i={...o};for(const a of s)if(a)switch(a.type){case"select":{i.selected=a.selected;break}case"position":{typeof a.position<"u"&&(i.position=a.position),typeof a.positionAbsolute<"u"&&(i.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(i.dragging=a.dragging),i.expandParent&&Cr(r,i);break}case"dimensions":{typeof a.dimensions<"u"&&(i.width=a.dimensions.width,i.height=a.dimensions.height),typeof a.updateStyle<"u"&&(i.style={...i.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(i.resizing=a.resizing),i.expandParent&&Cr(r,i);break}case"remove":return r}return r.push(i),r},n)}function Zo(e,t){return Uo(e,t)}function Ou(e,t){return Uo(e,t)}const Re=(e,t)=>({id:e,type:"select",selected:t});function ot(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(Re(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(Re(r.id,!1))),n},[])}const yn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Ru=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),qo=Y.memo(({isSelecting:e,selectionMode:t=It.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:s,onPaneContextMenu:i,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:d})=>{const g=Y.useRef(null),f=ue(),v=Y.useRef(0),w=Y.useRef(0),C=Y.useRef(),{userSelectionActive:_,elementsSelectable:x,dragging:I}=ie(Ru,de),m=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,w.current=0},$=M=>{s==null||s(M),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},z=M=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){M.preventDefault();return}i==null||i(M)},V=a?M=>a(M):void 0,H=M=>{const{resetSelectedElements:h,domNode:N}=f.getState();if(C.current=N==null?void 0:N.getBoundingClientRect(),!x||!e||M.button!==0||M.target!==g.current||!C.current)return;const{x:y,y:k}=De(M,C.current);h(),f.setState({userSelectionRect:{width:0,height:0,startX:y,startY:k,x:y,y:k}}),r==null||r(M)},B=M=>{const{userSelectionRect:h,nodeInternals:N,edges:y,transform:k,onNodesChange:R,onEdgesChange:E,nodeOrigin:O,getNodes:D}=f.getState();if(!e||!C.current||!h)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const F=De(M,C.current),G=h.startX??0,b=h.startY??0,p={...h,x:F.x<G?F.x:G,y:F.y<b?F.y:b,width:Math.abs(F.x-G),height:Math.abs(F.y-b)},T=D(),P=Ao(N,p,k,t===It.Partial,!0,O),j=To(P,y).map(U=>U.id),W=P.map(U=>U.id);if(v.current!==W.length){v.current=W.length;const U=ot(T,W);U.length&&(R==null||R(U))}if(w.current!==j.length){w.current=j.length;const U=ot(y,j);U.length&&(E==null||E(U))}f.setState({userSelectionRect:p})},S=M=>{if(M.button!==0)return;const{userSelectionRect:h}=f.getState();!_&&h&&M.target===g.current&&($==null||$(M)),f.setState({nodesSelectionActive:v.current>0}),m(),o==null||o(M)},A=M=>{_&&(f.setState({nodesSelectionActive:v.current>0}),o==null||o(M)),m()},L=x&&(e||_);return X.createElement("div",{className:fe(["react-flow__pane",{dragging:I,selection:e}]),onClick:L?void 0:yn($,g),onContextMenu:yn(z,g),onWheel:yn(V,g),onMouseEnter:L?void 0:c,onMouseDown:L?H:void 0,onMouseMove:L?B:u,onMouseUp:L?S:void 0,onMouseLeave:L?A:l,ref:g,style:qn},d,X.createElement($u,null))});qo.displayName="Pane";function Ko(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:Ko(r,t):!1}function Mr(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function zu(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!Ko(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>{var s,i;return{id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=o.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((i=o.positionAbsolute)==null?void 0:i.y)??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}})}function Du(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Qo(e,t,n,r,o=[0,0],s){const i=Du(e,e.extent||r);let a=i;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const d=n.get(c),{x:g,y:f}=Xe(d,o).positionAbsolute;a=d&&ye(g)&&ye(f)&&ye(d.width)&&ye(d.height)?[[g+e.width*o[0],f+e.height*o[1]],[g+d.width-e.width+e.width*o[0],f+d.height-e.height+e.height*o[1]]]:a}else s==null||s("005",$e.error005()),a=i;else if(e.extent&&c&&e.extent!=="parent"){const d=n.get(c),{x:g,y:f}=Xe(d,o).positionAbsolute;a=[[e.extent[0][0]+g,e.extent[0][1]+f],[e.extent[1][0]+g,e.extent[1][1]+f]]}let u={x:0,y:0};if(c){const d=n.get(c);u=Xe(d,o).positionAbsolute}const l=a&&a!=="parent"?Bn(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function vn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Ir=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const s=Array.from(o),i=t.getBoundingClientRect(),a={x:i.width*r[0],y:i.height*r[1]};return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-i.left-a.x)/n,y:(u.top-i.top-a.y)/n,...Hn(c)}})};function xt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function On({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:s,multiSelectionActive:i,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",$e.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&i)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var l;return(l=r==null?void 0:r.current)==null?void 0:l.blur()})):o([e])}function Pu(){const e=ue();return Y.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:s}=e.getState(),i=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(i-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?o[0]*Math.round(c.x/o[0]):c.x,ySnapped:s?o[1]*Math.round(c.y/o[1]):c.y,...c}},[])}function wn(e){return(t,n,r)=>e==null?void 0:e(t,r)}function Jo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:s,selectNodesOnDrag:i}){const a=ue(),[c,u]=Y.useState(!1),l=Y.useRef([]),d=Y.useRef({x:null,y:null}),g=Y.useRef(0),f=Y.useRef(null),v=Y.useRef({x:0,y:0}),w=Y.useRef(null),C=Y.useRef(!1),_=Y.useRef(!1),x=Y.useRef(!1),I=Pu();return Y.useEffect(()=>{if(e!=null&&e.current){const m=me(e.current),$=({x:H,y:B})=>{const{nodeInternals:S,onNodeDrag:A,onSelectionDrag:L,updateNodePositions:M,nodeExtent:h,snapGrid:N,snapToGrid:y,nodeOrigin:k,onError:R}=a.getState();d.current={x:H,y:B};let E=!1,O={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&h){const F=cn(l.current,k);O=Mt(F)}if(l.current=l.current.map(F=>{const G={x:H-F.distance.x,y:B-F.distance.y};y&&(G.x=N[0]*Math.round(G.x/N[0]),G.y=N[1]*Math.round(G.y/N[1]));const b=[[h[0][0],h[0][1]],[h[1][0],h[1][1]]];l.current.length>1&&h&&!F.extent&&(b[0][0]=F.positionAbsolute.x-O.x+h[0][0],b[1][0]=F.positionAbsolute.x+(F.width??0)-O.x2+h[1][0],b[0][1]=F.positionAbsolute.y-O.y+h[0][1],b[1][1]=F.positionAbsolute.y+(F.height??0)-O.y2+h[1][1]);const p=Qo(F,G,S,b,k,R);return E=E||F.position.x!==p.position.x||F.position.y!==p.position.y,F.position=p.position,F.positionAbsolute=p.positionAbsolute,F}),!E)return;M(l.current,!0,!0),u(!0);const D=o?A:wn(L);if(D&&w.current){const[F,G]=vn({nodeId:o,dragItems:l.current,nodeInternals:S});D(w.current,F,G)}},z=()=>{if(!f.current)return;const[H,B]=wo(v.current,f.current);if(H!==0||B!==0){const{transform:S,panBy:A}=a.getState();d.current.x=(d.current.x??0)-H/S[2],d.current.y=(d.current.y??0)-B/S[2],A({x:H,y:B})&&$(d.current)}g.current=requestAnimationFrame(z)},V=H=>{var k;const{nodeInternals:B,multiSelectionActive:S,nodesDraggable:A,unselectNodesAndEdges:L,onNodeDragStart:M,onSelectionDragStart:h}=a.getState();_.current=!0;const N=o?M:wn(h);(!i||!s)&&!S&&o&&((k=B.get(o))!=null&&k.selected||L()),o&&s&&i&&On({id:o,store:a,nodeRef:e});const y=I(H);if(d.current=y,l.current=zu(B,A,y,o),N&&l.current){const[R,E]=vn({nodeId:o,dragItems:l.current,nodeInternals:B});N(H.sourceEvent,R,E)}};if(t)m.on(".drag",null);else{const H=xc().on("start",B=>{const{domNode:S,nodeDragThreshold:A}=a.getState();A===0&&V(B),x.current=!1;const L=I(B);d.current=L,f.current=(S==null?void 0:S.getBoundingClientRect())||null,v.current=De(B.sourceEvent,f.current)}).on("drag",B=>{var M,h;const S=I(B),{autoPanOnNodeDrag:A,nodeDragThreshold:L}=a.getState();if(B.sourceEvent.type==="touchmove"&&B.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!C.current&&_.current&&A&&(C.current=!0,z()),!_.current){const N=S.xSnapped-(((M=d==null?void 0:d.current)==null?void 0:M.x)??0),y=S.ySnapped-(((h=d==null?void 0:d.current)==null?void 0:h.y)??0);Math.sqrt(N*N+y*y)>L&&V(B)}(d.current.x!==S.xSnapped||d.current.y!==S.ySnapped)&&l.current&&_.current&&(w.current=B.sourceEvent,v.current=De(B.sourceEvent,f.current),$(S))}}).on("end",B=>{if(!(!_.current||x.current)&&(u(!1),C.current=!1,_.current=!1,cancelAnimationFrame(g.current),l.current)){const{updateNodePositions:S,nodeInternals:A,onNodeDragStop:L,onSelectionDragStop:M}=a.getState(),h=o?L:wn(M);if(S(l.current,!1,!1),h){const[N,y]=vn({nodeId:o,dragItems:l.current,nodeInternals:A});h(B.sourceEvent,N,y)}}}).filter(B=>{const S=B.target;return!B.button&&(!n||!Mr(S,`.${n}`,e))&&(!r||Mr(S,r,e))});return m.call(H),()=>{m.on(".drag",null)}}}},[e,t,n,r,s,a,o,i,I]),c}function ei(){const e=ue();return Y.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:s,getNodes:i,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),d=i().filter(x=>x.selected&&(x.draggable||l&&typeof x.draggable>"u")),g=a?c[0]:5,f=a?c[1]:5,v=n.isShiftPressed?4:1,w=n.x*g*v,C=n.y*f*v,_=d.map(x=>{if(x.positionAbsolute){const I={x:x.positionAbsolute.x+w,y:x.positionAbsolute.y+C};a&&(I.x=c[0]*Math.round(I.x/c[0]),I.y=c[1]*Math.round(I.y/c[1]));const{positionAbsolute:m,position:$}=Qo(x,I,r,o,void 0,u);x.position=$,x.positionAbsolute=m}return x});s(_,!0,!1)},[])}const st={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var bt=e=>{const t=({id:n,type:r,data:o,xPos:s,yPos:i,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:d,onMouseMove:g,onMouseLeave:f,onContextMenu:v,onDoubleClick:w,style:C,className:_,isDraggable:x,isSelectable:I,isConnectable:m,isFocusable:$,selectNodesOnDrag:z,sourcePosition:V,targetPosition:H,hidden:B,resizeObserver:S,dragHandle:A,zIndex:L,isParent:M,noDragClassName:h,noPanClassName:N,initialized:y,disableKeyboardA11y:k,ariaLabel:R,rfId:E,hasHandleBounds:O})=>{const D=ue(),F=Y.useRef(null),G=Y.useRef(null),b=Y.useRef(V),p=Y.useRef(H),T=Y.useRef(r),P=I||x||l||d||g||f,j=ei(),W=xt(n,D.getState,d),U=xt(n,D.getState,g),Z=xt(n,D.getState,f),J=xt(n,D.getState,v),ae=xt(n,D.getState,w),re=ne=>{const{nodeDragThreshold:q}=D.getState();if(I&&(!z||!x||q>0)&&On({id:n,store:D,nodeRef:F}),l){const ge=D.getState().nodeInternals.get(n);ge&&l(ne,{...ge})}},te=ne=>{if(!Mn(ne)&&!k)if(_o.includes(ne.key)&&I){const q=ne.key==="Escape";On({id:n,store:D,unselect:q,nodeRef:F})}else x&&u&&Object.prototype.hasOwnProperty.call(st,ne.key)&&(D.setState({ariaLiveMessage:`Moved selected node ${ne.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~i}`}),j({x:st[ne.key].x,y:st[ne.key].y,isShiftPressed:ne.shiftKey}))};Y.useEffect(()=>()=>{G.current&&(S==null||S.unobserve(G.current),G.current=null)},[]),Y.useEffect(()=>{if(F.current&&!B){const ne=F.current;(!y||!O||G.current!==ne)&&(G.current&&(S==null||S.unobserve(G.current)),S==null||S.observe(ne),G.current=ne)}},[B,y,O]),Y.useEffect(()=>{const ne=T.current!==r,q=b.current!==V,ge=p.current!==H;F.current&&(ne||q||ge)&&(ne&&(T.current=r),q&&(b.current=V),ge&&(p.current=H),D.getState().updateNodeDimensions([{id:n,nodeElement:F.current,forceUpdate:!0}]))},[n,r,V,H]);const le=Jo({nodeRef:F,disabled:B||!x,noDragClassName:h,handleSelector:A,nodeId:n,isSelectable:I,selectNodesOnDrag:z});return B?null:X.createElement("div",{className:fe(["react-flow__node",`react-flow__node-${r}`,{[N]:x},_,{selected:u,selectable:I,parent:M,dragging:le}]),ref:F,style:{zIndex:L,transform:`translate(${a}px,${c}px)`,pointerEvents:P?"all":"none",visibility:y?"visible":"hidden",...C},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:W,onMouseMove:U,onMouseLeave:Z,onContextMenu:J,onClick:re,onDoubleClick:ae,onKeyDown:$?te:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":k?void 0:`${jo}-${E}`,"aria-label":R},X.createElement(Kl,{value:n},X.createElement(e,{id:n,data:o,type:r,xPos:s,yPos:i,selected:u,isConnectable:m,sourcePosition:V,targetPosition:H,dragging:le,dragHandle:A,zIndex:L})))};return t.displayName="NodeWrapper",Y.memo(t)};const Lu=e=>{const t=e.getNodes().filter(n=>n.selected);return{...cn(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Vu({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ue(),{width:o,height:s,x:i,y:a,transformString:c,userSelectionActive:u}=ie(Lu,de),l=ei(),d=Y.useRef(null);if(Y.useEffect(()=>{var v;n||(v=d.current)==null||v.focus({preventScroll:!0})},[n]),Jo({nodeRef:d}),u||!o||!s)return null;const g=e?v=>{const w=r.getState().getNodes().filter(C=>C.selected);e(v,w)}:void 0,f=v=>{Object.prototype.hasOwnProperty.call(st,v.key)&&l({x:st[v.key].x,y:st[v.key].y,isShiftPressed:v.shiftKey})};return X.createElement("div",{className:fe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},X.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:o,height:s,top:a,left:i}}))}var Fu=Y.memo(Vu);const Hu=e=>e.nodesSelectionActive,ti=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:d,selectionOnDrag:g,selectionMode:f,onSelectionStart:v,onSelectionEnd:w,multiSelectionKeyCode:C,panActivationKeyCode:_,zoomActivationKeyCode:x,elementsSelectable:I,zoomOnScroll:m,zoomOnPinch:$,panOnScroll:z,panOnScrollSpeed:V,panOnScrollMode:H,zoomOnDoubleClick:B,panOnDrag:S,defaultViewport:A,translateExtent:L,minZoom:M,maxZoom:h,preventScrolling:N,onSelectionContextMenu:y,noWheelClassName:k,noPanClassName:R,disableKeyboardA11y:E})=>{const O=ie(Hu),D=At(d),F=At(_),G=F||S,b=F||z,p=D||g&&G!==!0;return ku({deleteKeyCode:a,multiSelectionKeyCode:C}),X.createElement(Au,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:s,elementsSelectable:I,zoomOnScroll:m,zoomOnPinch:$,panOnScroll:b,panOnScrollSpeed:V,panOnScrollMode:H,zoomOnDoubleClick:B,panOnDrag:!D&&G,defaultViewport:A,translateExtent:L,minZoom:M,maxZoom:h,zoomActivationKeyCode:x,preventScrolling:N,noWheelClassName:k,noPanClassName:R},X.createElement(qo,{onSelectionStart:v,onSelectionEnd:w,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:G,isSelecting:!!p,selectionMode:f},e,O&&X.createElement(Fu,{onSelectionContextMenu:y,noPanClassName:R,disableKeyboardA11y:E})))};ti.displayName="FlowRenderer";var Bu=Y.memo(ti);function ju(e){return ie(Y.useCallback(n=>e?Ao(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Yu(e){const t={input:bt(e.input||Vo),default:bt(e.default||$n),output:bt(e.output||Ho),group:bt(e.group||Un)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,s)=>(o[s]=bt(e[s]||$n),o),n);return{...t,...r}}const Gu=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Xu=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),ni=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:s,onError:i}=ie(Xu,de),a=ju(e.onlyRenderVisibleElements),c=Y.useRef(),u=Y.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(d=>{const g=d.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));s(g)});return c.current=l,l},[]);return Y.useEffect(()=>()=>{var l;(l=c==null?void 0:c.current)==null||l.disconnect()},[]),X.createElement("div",{className:"react-flow__nodes",style:qn},a.map(l=>{var $,z,V;let d=l.type||"default";e.nodeTypes[d]||(i==null||i("003",$e.error003(d)),d="default");const g=e.nodeTypes[d]||e.nodeTypes.default,f=!!(l.draggable||t&&typeof l.draggable>"u"),v=!!(l.selectable||o&&typeof l.selectable>"u"),w=!!(l.connectable||n&&typeof l.connectable>"u"),C=!!(l.focusable||r&&typeof l.focusable>"u"),_=e.nodeExtent?Bn(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,x=(_==null?void 0:_.x)??0,I=(_==null?void 0:_.y)??0,m=Gu({x,y:I,width:l.width??0,height:l.height??0,origin:e.nodeOrigin});return X.createElement(g,{key:l.id,id:l.id,className:l.className,style:l.style,type:d,data:l.data,sourcePosition:l.sourcePosition||K.Bottom,targetPosition:l.targetPosition||K.Top,hidden:l.hidden,xPos:x,yPos:I,xPosOrigin:m.x,yPosOrigin:m.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:f,isSelectable:v,isConnectable:w,isFocusable:C,resizeObserver:u,dragHandle:l.dragHandle,zIndex:(($=l[se])==null?void 0:$.z)??0,isParent:!!((z=l[se])!=null&&z.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!((V=l[se])!=null&&V.handleBounds)})}))};ni.displayName="NodeRenderer";var Wu=Y.memo(ni);const Uu=(e,t,n)=>n===K.Left?e-t:n===K.Right?e+t:e,Zu=(e,t,n)=>n===K.Top?e-t:n===K.Bottom?e+t:e,Ar="react-flow__edgeupdater",Tr=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:s,onMouseOut:i,type:a})=>X.createElement("circle",{onMouseDown:o,onMouseEnter:s,onMouseOut:i,className:fe([Ar,`${Ar}-${a}`]),cx:Uu(t,r,e),cy:Zu(n,r,e),r,stroke:"transparent",fill:"transparent"}),qu=()=>!0;var rt=e=>{const t=({id:n,className:r,type:o,data:s,onClick:i,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:v,labelBgBorderRadius:w,style:C,source:_,target:x,sourceX:I,sourceY:m,targetX:$,targetY:z,sourcePosition:V,targetPosition:H,elementsSelectable:B,hidden:S,sourceHandleId:A,targetHandleId:L,onContextMenu:M,onMouseEnter:h,onMouseMove:N,onMouseLeave:y,reconnectRadius:k,onReconnect:R,onReconnectStart:E,onReconnectEnd:O,markerEnd:D,markerStart:F,rfId:G,ariaLabel:b,isFocusable:p,isReconnectable:T,pathOptions:P,interactionWidth:j,disableKeyboardA11y:W})=>{const U=Y.useRef(null),[Z,J]=Y.useState(!1),[ae,re]=Y.useState(!1),te=ue(),le=Y.useMemo(()=>`url('#${An(F,G)}')`,[F,G]),ne=Y.useMemo(()=>`url('#${An(D,G)}')`,[D,G]);if(S)return null;const q=he=>{var _e;const{edges:we,addSelectedEdges:Ve,unselectNodesAndEdges:Fe,multiSelectionActive:He}=te.getState(),Ce=we.find(pt=>pt.id===n);Ce&&(B&&(te.setState({nodesSelectionActive:!1}),Ce.selected&&He?(Fe({nodes:[],edges:[Ce]}),(_e=U.current)==null||_e.blur()):Ve([n])),i&&i(he,Ce))},ge=wt(n,te.getState,a),Se=wt(n,te.getState,M),ht=wt(n,te.getState,h),Ze=wt(n,te.getState,N),qe=wt(n,te.getState,y),ke=(he,we)=>{if(he.button!==0)return;const{edges:Ve,isValidConnection:Fe}=te.getState(),He=we?x:_,Ce=(we?L:A)||null,_e=we?"target":"source",pt=Fe||qu,ln=we,mt=Ve.find(Be=>Be.id===n);re(!0),E==null||E(he,mt,_e);const un=Be=>{re(!1),O==null||O(Be,mt,_e)};zo({event:he,handleId:Ce,nodeId:He,onConnect:Be=>R==null?void 0:R(mt,Be),isTarget:ln,getState:te.getState,setState:te.setState,isValidConnection:pt,edgeUpdaterType:_e,onReconnectEnd:un})},Ke=he=>ke(he,!0),Pe=he=>ke(he,!1),Le=()=>J(!0),Qe=()=>J(!1),Je=!B&&!i,gt=he=>{var we;if(!W&&_o.includes(he.key)&&B){const{unselectNodesAndEdges:Ve,addSelectedEdges:Fe,edges:He}=te.getState();he.key==="Escape"?((we=U.current)==null||we.blur(),Ve({edges:[He.find(_e=>_e.id===n)]})):Fe([n])}};return X.createElement("g",{className:fe(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:c,animated:u,inactive:Je,updating:Z}]),onClick:q,onDoubleClick:ge,onContextMenu:Se,onMouseEnter:ht,onMouseMove:Ze,onMouseLeave:qe,onKeyDown:p?gt:void 0,tabIndex:p?0:void 0,role:p?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":b===null?void 0:b||`Edge from ${_} to ${x}`,"aria-describedby":p?`${Yo}-${G}`:void 0,ref:U},!ae&&X.createElement(e,{id:n,source:_,target:x,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:v,labelBgBorderRadius:w,data:s,style:C,sourceX:I,sourceY:m,targetX:$,targetY:z,sourcePosition:V,targetPosition:H,sourceHandleId:A,targetHandleId:L,markerStart:le,markerEnd:ne,pathOptions:P,interactionWidth:j}),T&&X.createElement(X.Fragment,null,(T==="source"||T===!0)&&X.createElement(Tr,{position:V,centerX:I,centerY:m,radius:k,onMouseDown:Ke,onMouseEnter:Le,onMouseOut:Qe,type:"source"}),(T==="target"||T===!0)&&X.createElement(Tr,{position:H,centerX:$,centerY:z,radius:k,onMouseDown:Pe,onMouseEnter:Le,onMouseOut:Qe,type:"target"})))};return t.displayName="EdgeWrapper",Y.memo(t)};function Ku(e){const t={default:rt(e.default||Kt),straight:rt(e.bezier||Gn),step:rt(e.step||Yn),smoothstep:rt(e.step||an),simplebezier:rt(e.simplebezier||jn)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,s)=>(o[s]=rt(e[s]||Kt),o),n);return{...t,...r}}function $r(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,s=(n==null?void 0:n.width)||t.width,i=(n==null?void 0:n.height)||t.height;switch(e){case K.Top:return{x:r+s/2,y:o};case K.Right:return{x:r+s,y:o+i/2};case K.Bottom:return{x:r+s/2,y:o+i};case K.Left:return{x:r,y:o+i/2}}}function Or(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Qu=(e,t,n,r,o,s)=>{const i=$r(n,e,t),a=$r(s,r,o);return{sourceX:i.x,sourceY:i.y,targetX:a.x,targetY:a.y}};function Ju({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:s,width:i,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=Mt({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:i/c[2],height:a/c[2]}),d=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),g=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(d*g)>0}function Rr(e){var r,o,s,i,a;const t=((r=e==null?void 0:e[se])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const ed=[{level:0,isMaxLevel:!0,edges:[]}];function td(e,t,n=!1){let r=-1;const o=e.reduce((i,a)=>{var l,d;const c=ye(a.zIndex);let u=c?a.zIndex:0;if(n){const g=t.get(a.target),f=t.get(a.source),v=a.selected||(g==null?void 0:g.selected)||(f==null?void 0:f.selected),w=Math.max(((l=f==null?void 0:f[se])==null?void 0:l.z)||0,((d=g==null?void 0:g[se])==null?void 0:d.z)||0,1e3);u=(c?a.zIndex:0)+(v?w:0)}return i[u]?i[u].push(a):i[u]=[a],r=u>r?u:r,i},{}),s=Object.entries(o).map(([i,a])=>{const c=+i;return{edges:a,level:c,isMaxLevel:c===r}});return s.length===0?ed:s}function nd(e,t,n){const r=ie(Y.useCallback(o=>e?o.edges.filter(s=>{const i=t.get(s.source),a=t.get(s.target);return(i==null?void 0:i.width)&&(i==null?void 0:i.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Ju({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return td(r,t,n)}const rd=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),od=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),zr={[qt.Arrow]:rd,[qt.ArrowClosed]:od};function id(e){const t=ue();return Y.useMemo(()=>{var o,s;return Object.prototype.hasOwnProperty.call(zr,e)?zr[e]:((s=(o=t.getState()).onError)==null||s.call(o,"009",$e.error009(e)),null)},[e])}const sd=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=id(t);return c?X.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},X.createElement(c,{color:n,strokeWidth:i})):null},ad=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,s)=>([s.markerStart,s.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const a=An(i,t);r.includes(a)||(o.push({id:a,color:i.color||e,...i}),r.push(a))}}),o),[]).sort((o,s)=>o.id.localeCompare(s.id))},ri=({defaultColor:e,rfId:t})=>{const n=ie(Y.useCallback(ad({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((s,i)=>s.id!==o[i].id)));return X.createElement("defs",null,n.map(r=>X.createElement(sd,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};ri.displayName="MarkerDefinitions";var cd=Y.memo(ri);const ld=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),oi=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:v,reconnectRadius:w,children:C,disableKeyboardA11y:_})=>{const{edgesFocusable:x,edgesUpdatable:I,elementsSelectable:m,width:$,height:z,connectionMode:V,nodeInternals:H,onError:B}=ie(ld,de),S=nd(t,H,n);return $?X.createElement(X.Fragment,null,S.map(({level:A,edges:L,isMaxLevel:M})=>X.createElement("svg",{key:A,style:{zIndex:A},width:$,height:z,className:"react-flow__edges react-flow__container"},M&&X.createElement(cd,{defaultColor:e,rfId:r}),X.createElement("g",null,L.map(h=>{const[N,y,k]=Rr(H.get(h.source)),[R,E,O]=Rr(H.get(h.target));if(!k||!O)return null;let D=h.type||"default";o[D]||(B==null||B("011",$e.error011(D)),D="default");const F=o[D]||o.default,G=V===Ue.Strict?E.target:(E.target??[]).concat(E.source??[]),b=Or(y.source,h.sourceHandle),p=Or(G,h.targetHandle),T=(b==null?void 0:b.position)||K.Bottom,P=(p==null?void 0:p.position)||K.Top,j=!!(h.focusable||x&&typeof h.focusable>"u"),W=h.reconnectable||h.updatable,U=typeof g<"u"&&(W||I&&typeof W>"u");if(!b||!p)return B==null||B("008",$e.error008(b,h)),null;const{sourceX:Z,sourceY:J,targetX:ae,targetY:re}=Qu(N,b,T,R,p,P);return X.createElement(F,{key:h.id,id:h.id,className:fe([h.className,s]),type:D,data:h.data,selected:!!h.selected,animated:!!h.animated,hidden:!!h.hidden,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,style:h.style,source:h.source,target:h.target,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerEnd:h.markerEnd,markerStart:h.markerStart,sourceX:Z,sourceY:J,targetX:ae,targetY:re,sourcePosition:T,targetPosition:P,elementsSelectable:m,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:v,reconnectRadius:w,rfId:r,ariaLabel:h.ariaLabel,isFocusable:j,isReconnectable:U,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth,disableKeyboardA11y:_})})))),C):null};oi.displayName="EdgeRenderer";var ud=Y.memo(oi);const dd=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function fd({children:e}){const t=ie(dd);return X.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function hd(e){const t=Zn(),n=Y.useRef(!1);Y.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const gd={[K.Left]:K.Right,[K.Right]:K.Left,[K.Top]:K.Bottom,[K.Bottom]:K.Top},ii=({nodeId:e,handleType:t,style:n,type:r=ze.Bezier,CustomComponent:o,connectionStatus:s})=>{var z,V,H;const{fromNode:i,handleId:a,toX:c,toY:u,connectionMode:l}=ie(Y.useCallback(B=>({fromNode:B.nodeInternals.get(e),handleId:B.connectionHandleId,toX:(B.connectionPosition.x-B.transform[0])/B.transform[2],toY:(B.connectionPosition.y-B.transform[1])/B.transform[2],connectionMode:B.connectionMode}),[e]),de),d=(z=i==null?void 0:i[se])==null?void 0:z.handleBounds;let g=d==null?void 0:d[t];if(l===Ue.Loose&&(g=g||(d==null?void 0:d[t==="source"?"target":"source"])),!i||!g)return null;const f=a?g.find(B=>B.id===a):g[0],v=f?f.x+f.width/2:(i.width??0)/2,w=f?f.y+f.height/2:i.height??0,C=(((V=i.positionAbsolute)==null?void 0:V.x)??0)+v,_=(((H=i.positionAbsolute)==null?void 0:H.y)??0)+w,x=f==null?void 0:f.position,I=x?gd[x]:null;if(!x||!I)return null;if(o)return X.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:i,fromHandle:f,fromX:C,fromY:_,toX:c,toY:u,fromPosition:x,toPosition:I,connectionStatus:s});let m="";const $={sourceX:C,sourceY:_,sourcePosition:x,targetX:c,targetY:u,targetPosition:I};return r===ze.Bezier?[m]=Mo($):r===ze.Step?[m]=In({...$,borderRadius:0}):r===ze.SmoothStep?[m]=In($):r===ze.SimpleBezier?[m]=Co($):m=`M${C},${_} ${c},${u}`,X.createElement("path",{d:m,fill:"none",className:"react-flow__connection-path",style:n})};ii.displayName="ConnectionLine";const pd=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function md({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:s,nodesConnectable:i,width:a,height:c,connectionStatus:u}=ie(pd,de);return!(o&&s&&a&&i)?null:X.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},X.createElement("g",{className:fe(["react-flow__connection",u])},X.createElement(ii,{nodeId:o,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function Dr(e,t){return Y.useRef(null),ue(),Y.useMemo(()=>t(e),[e])}const si=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:s,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,onSelectionContextMenu:v,onSelectionStart:w,onSelectionEnd:C,connectionLineType:_,connectionLineStyle:x,connectionLineComponent:I,connectionLineContainerStyle:m,selectionKeyCode:$,selectionOnDrag:z,selectionMode:V,multiSelectionKeyCode:H,panActivationKeyCode:B,zoomActivationKeyCode:S,deleteKeyCode:A,onlyRenderVisibleElements:L,elementsSelectable:M,selectNodesOnDrag:h,defaultViewport:N,translateExtent:y,minZoom:k,maxZoom:R,preventScrolling:E,defaultMarkerColor:O,zoomOnScroll:D,zoomOnPinch:F,panOnScroll:G,panOnScrollSpeed:b,panOnScrollMode:p,zoomOnDoubleClick:T,panOnDrag:P,onPaneClick:j,onPaneMouseEnter:W,onPaneMouseMove:U,onPaneMouseLeave:Z,onPaneScroll:J,onPaneContextMenu:ae,onEdgeContextMenu:re,onEdgeMouseEnter:te,onEdgeMouseMove:le,onEdgeMouseLeave:ne,onReconnect:q,onReconnectStart:ge,onReconnectEnd:Se,reconnectRadius:ht,noDragClassName:Ze,noWheelClassName:qe,noPanClassName:ke,elevateEdgesOnSelect:Ke,disableKeyboardA11y:Pe,nodeOrigin:Le,nodeExtent:Qe,rfId:Je})=>{const gt=Dr(e,Yu),he=Dr(t,Ku);return hd(s),X.createElement(Bu,{onPaneClick:j,onPaneMouseEnter:W,onPaneMouseMove:U,onPaneMouseLeave:Z,onPaneContextMenu:ae,onPaneScroll:J,deleteKeyCode:A,selectionKeyCode:$,selectionOnDrag:z,selectionMode:V,onSelectionStart:w,onSelectionEnd:C,multiSelectionKeyCode:H,panActivationKeyCode:B,zoomActivationKeyCode:S,elementsSelectable:M,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:D,zoomOnPinch:F,zoomOnDoubleClick:T,panOnScroll:G,panOnScrollSpeed:b,panOnScrollMode:p,panOnDrag:P,defaultViewport:N,translateExtent:y,minZoom:k,maxZoom:R,onSelectionContextMenu:v,preventScrolling:E,noDragClassName:Ze,noWheelClassName:qe,noPanClassName:ke,disableKeyboardA11y:Pe},X.createElement(fd,null,X.createElement(ud,{edgeTypes:he,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:L,onEdgeContextMenu:re,onEdgeMouseEnter:te,onEdgeMouseMove:le,onEdgeMouseLeave:ne,onReconnect:q,onReconnectStart:ge,onReconnectEnd:Se,reconnectRadius:ht,defaultMarkerColor:O,noPanClassName:ke,elevateEdgesOnSelect:!!Ke,disableKeyboardA11y:Pe,rfId:Je},X.createElement(md,{style:x,type:_,component:I,containerStyle:m})),X.createElement("div",{className:"react-flow__edgelabel-renderer"}),X.createElement(Wu,{nodeTypes:gt,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,selectNodesOnDrag:h,onlyRenderVisibleElements:L,noPanClassName:ke,noDragClassName:Ze,disableKeyboardA11y:Pe,nodeOrigin:Le,nodeExtent:Qe,rfId:Je})))};si.displayName="GraphView";var yd=Y.memo(si);const Rn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Oe={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Rn,nodeExtent:Rn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ue.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Gl,isValidConnection:void 0},vd=()=>$s((e,t)=>({...Oe,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:s}=t();e({nodeInternals:mn(n,r,o,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",s=typeof r<"u",i=o?mn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:s?r:[],hasDefaultNodes:o,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:s,fitViewOnInitDone:i,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c==null?void 0:c.querySelector(".react-flow__viewport");if(!l)return;const d=window.getComputedStyle(l),{m22:g}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((w,C)=>{const _=o.get(C.id);if(_!=null&&_.hidden)o.set(_.id,{..._,[se]:{..._[se],handleBounds:void 0}});else if(_){const x=Hn(C.nodeElement);!!(x.width&&x.height&&(_.width!==x.width||_.height!==x.height||C.forceUpdate))&&(o.set(_.id,{..._,[se]:{..._[se],handleBounds:{source:Ir(".source",C.nodeElement,g,u),target:Ir(".target",C.nodeElement,g,u)}},...x}),w.push({id:_.id,type:"dimensions",dimensions:x}))}return w},[]);Xo(o,u);const v=i||s&&!i&&Wo(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:v}),(f==null?void 0:f.length)>0&&(r==null||r(f))},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:s}=t(),i=n.map(a=>{const c={id:a.id,type:"position",dragging:o};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});s(i)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:s,nodeOrigin:i,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(s){const u=Zo(n,a()),l=mn(u,o,i,c);e({nodeInternals:l})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:s}=t();let i,a=null;r?i=n.map(c=>Re(c,!0)):(i=ot(s(),n),a=ot(o,[])),Lt({changedNodes:i,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:s}=t();let i,a=null;r?i=n.map(c=>Re(c,!0)):(i=ot(o,n),a=ot(s(),[])),Lt({changedNodes:a,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:s}=t(),i=n||s(),a=r||o,c=i.map(l=>(l.selected=!1,Re(l.id,!1))),u=a.map(l=>Re(l.id,!1));Lt({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(a=>a.selected).map(a=>Re(a.id,!1)),i=n.filter(a=>a.selected).map(a=>Re(a.id,!1));Lt({changedNodes:s,changedEdges:i,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=Bn(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:s,d3Zoom:i,d3Selection:a,translateExtent:c}=t();if(!i||!a||!n.x&&!n.y)return!1;const u=Ae.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),l=[[0,0],[o,s]],d=i==null?void 0:i.constrain()(u,l,c);return i.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Oe.connectionNodeId,connectionHandleId:Oe.connectionHandleId,connectionHandleType:Oe.connectionHandleType,connectionStatus:Oe.connectionStatus,connectionStartHandle:Oe.connectionStartHandle,connectionEndHandle:Oe.connectionEndHandle}),reset:()=>e({...Oe})}),Object.is),ai=({children:e})=>{const t=Y.useRef(null);return t.current||(t.current=vd()),X.createElement(Ll,{value:t.current},e)};ai.displayName="ReactFlowProvider";const ci=({children:e})=>Y.useContext(sn)?X.createElement(X.Fragment,null,e):X.createElement(ai,null,e);ci.displayName="ReactFlowWrapper";const wd={input:Vo,default:$n,output:Ho,group:Un},xd={default:Kt,straight:Gn,step:Yn,smoothstep:an,simplebezier:jn},bd=[0,0],Ed=[15,15],_d={x:0,y:0,zoom:1},Nd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},li=Y.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:s=wd,edgeTypes:i=xd,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:d,onMoveEnd:g,onConnect:f,onConnectStart:v,onConnectEnd:w,onClickConnectStart:C,onClickConnectEnd:_,onNodeMouseEnter:x,onNodeMouseMove:I,onNodeMouseLeave:m,onNodeContextMenu:$,onNodeDoubleClick:z,onNodeDragStart:V,onNodeDrag:H,onNodeDragStop:B,onNodesDelete:S,onEdgesDelete:A,onSelectionChange:L,onSelectionDragStart:M,onSelectionDrag:h,onSelectionDragStop:N,onSelectionContextMenu:y,onSelectionStart:k,onSelectionEnd:R,connectionMode:E=Ue.Strict,connectionLineType:O=ze.Bezier,connectionLineStyle:D,connectionLineComponent:F,connectionLineContainerStyle:G,deleteKeyCode:b="Backspace",selectionKeyCode:p="Shift",selectionOnDrag:T=!1,selectionMode:P=It.Full,panActivationKeyCode:j="Space",multiSelectionKeyCode:W=Zt()?"Meta":"Control",zoomActivationKeyCode:U=Zt()?"Meta":"Control",snapToGrid:Z=!1,snapGrid:J=Ed,onlyRenderVisibleElements:ae=!1,selectNodesOnDrag:re=!0,nodesDraggable:te,nodesConnectable:le,nodesFocusable:ne,nodeOrigin:q=bd,edgesFocusable:ge,edgesUpdatable:Se,elementsSelectable:ht,defaultViewport:Ze=_d,minZoom:qe=.5,maxZoom:ke=2,translateExtent:Ke=Rn,preventScrolling:Pe=!0,nodeExtent:Le,defaultMarkerColor:Qe="#b1b1b7",zoomOnScroll:Je=!0,zoomOnPinch:gt=!0,panOnScroll:he=!1,panOnScrollSpeed:we=.5,panOnScrollMode:Ve=Ge.Free,zoomOnDoubleClick:Fe=!0,panOnDrag:He=!0,onPaneClick:Ce,onPaneMouseEnter:_e,onPaneMouseMove:pt,onPaneMouseLeave:ln,onPaneScroll:mt,onPaneContextMenu:un,children:Kn,onEdgeContextMenu:Be,onEdgeDoubleClick:mi,onEdgeMouseEnter:yi,onEdgeMouseMove:vi,onEdgeMouseLeave:wi,onEdgeUpdate:xi,onEdgeUpdateStart:bi,onEdgeUpdateEnd:Ei,onReconnect:_i,onReconnectStart:Ni,onReconnectEnd:Si,reconnectRadius:ki=10,edgeUpdaterRadius:Ci=10,onNodesChange:Mi,onEdgesChange:Ii,noDragClassName:Ai="nodrag",noWheelClassName:Ti="nowheel",noPanClassName:Qn="nopan",fitView:$i=!1,fitViewOptions:Oi,connectOnClick:Ri=!0,attributionPosition:zi,proOptions:Di,defaultEdgeOptions:Pi,elevateNodesOnSelect:Li=!0,elevateEdgesOnSelect:Vi=!1,disableKeyboardA11y:Jn=!1,autoPanOnConnect:Fi=!0,autoPanOnNodeDrag:Hi=!0,connectionRadius:Bi=20,isValidConnection:ji,onError:Yi,style:Gi,id:er,nodeDragThreshold:Xi,...Wi},Ui)=>{const dn=er||"1";return X.createElement("div",{...Wi,style:{...Gi,...Nd},ref:Ui,className:fe(["react-flow",o]),"data-testid":"rf__wrapper",id:er},X.createElement(ci,null,X.createElement(yd,{onInit:u,onMove:l,onMoveStart:d,onMoveEnd:g,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:I,onNodeMouseLeave:m,onNodeContextMenu:$,onNodeDoubleClick:z,nodeTypes:s,edgeTypes:i,connectionLineType:O,connectionLineStyle:D,connectionLineComponent:F,connectionLineContainerStyle:G,selectionKeyCode:p,selectionOnDrag:T,selectionMode:P,deleteKeyCode:b,multiSelectionKeyCode:W,panActivationKeyCode:j,zoomActivationKeyCode:U,onlyRenderVisibleElements:ae,selectNodesOnDrag:re,defaultViewport:Ze,translateExtent:Ke,minZoom:qe,maxZoom:ke,preventScrolling:Pe,zoomOnScroll:Je,zoomOnPinch:gt,zoomOnDoubleClick:Fe,panOnScroll:he,panOnScrollSpeed:we,panOnScrollMode:Ve,panOnDrag:He,onPaneClick:Ce,onPaneMouseEnter:_e,onPaneMouseMove:pt,onPaneMouseLeave:ln,onPaneScroll:mt,onPaneContextMenu:un,onSelectionContextMenu:y,onSelectionStart:k,onSelectionEnd:R,onEdgeContextMenu:Be,onEdgeDoubleClick:mi,onEdgeMouseEnter:yi,onEdgeMouseMove:vi,onEdgeMouseLeave:wi,onReconnect:_i??xi,onReconnectStart:Ni??bi,onReconnectEnd:Si??Ei,reconnectRadius:ki??Ci,defaultMarkerColor:Qe,noDragClassName:Ai,noWheelClassName:Ti,noPanClassName:Qn,elevateEdgesOnSelect:Vi,rfId:dn,disableKeyboardA11y:Jn,nodeOrigin:q,nodeExtent:Le}),X.createElement(gu,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:f,onConnectStart:v,onConnectEnd:w,onClickConnectStart:C,onClickConnectEnd:_,nodesDraggable:te,nodesConnectable:le,nodesFocusable:ne,edgesFocusable:ge,edgesUpdatable:Se,elementsSelectable:ht,elevateNodesOnSelect:Li,minZoom:qe,maxZoom:ke,nodeExtent:Le,onNodesChange:Mi,onEdgesChange:Ii,snapToGrid:Z,snapGrid:J,connectionMode:E,translateExtent:Ke,connectOnClick:Ri,defaultEdgeOptions:Pi,fitView:$i,fitViewOptions:Oi,onNodesDelete:S,onEdgesDelete:A,onNodeDragStart:V,onNodeDrag:H,onNodeDragStop:B,onSelectionDrag:h,onSelectionDragStart:M,onSelectionDragStop:N,noPanClassName:Qn,nodeOrigin:q,rfId:dn,autoPanOnConnect:Fi,autoPanOnNodeDrag:Hi,onError:Yi,connectionRadius:Bi,isValidConnection:ji,nodeDragThreshold:Xi}),X.createElement(fu,{onSelectionChange:L}),Kn,X.createElement(Fl,{proOptions:Di,position:zi}),X.createElement(wu,{rfId:dn,disableKeyboardA11y:Jn})))});li.displayName="ReactFlow";function ui(e){return t=>{const[n,r]=Y.useState(t),o=Y.useCallback(s=>r(i=>e(s,i)),[]);return[n,r,o]}}const Sd=ui(Zo),kd=ui(Ou),di=({id:e,x:t,y:n,width:r,height:o,style:s,color:i,strokeColor:a,strokeWidth:c,className:u,borderRadius:l,shapeRendering:d,onClick:g,selected:f})=>{const{background:v,backgroundColor:w}=s||{},C=i||v||w;return X.createElement("rect",{className:fe(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:l,ry:l,width:r,height:o,fill:C,stroke:a,strokeWidth:c,shapeRendering:d,onClick:g?_=>g(_,e):void 0})};di.displayName="MiniMapNode";var Cd=Y.memo(di);const Md=e=>e.nodeOrigin,Id=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),xn=e=>e instanceof Function?e:()=>e;function Ad({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o=2,nodeComponent:s=Cd,onClick:i}){const a=ie(Id,de),c=ie(Md),u=xn(t),l=xn(e),d=xn(n),g=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return X.createElement(X.Fragment,null,a.map(f=>{const{x:v,y:w}=Xe(f,c).positionAbsolute;return X.createElement(s,{key:f.id,x:v,y:w,width:f.width,height:f.height,style:f.style,selected:f.selected,className:d(f),color:u(f),borderRadius:r,strokeColor:l(f),strokeWidth:o,shapeRendering:g,onClick:i,id:f.id})}))}var Td=Y.memo(Ad);const $d=200,Od=150,Rd=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?jl(cn(t,e.nodeOrigin),n):n,rfId:e.rfId}},zd="react-flow__minimap-desc";function fi({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:o="",nodeBorderRadius:s=5,nodeStrokeWidth:i=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:l=1,position:d="bottom-right",onClick:g,onNodeClick:f,pannable:v=!1,zoomable:w=!1,ariaLabel:C="React Flow mini map",inversePan:_=!1,zoomStep:x=10,offsetScale:I=5}){const m=ue(),$=Y.useRef(null),{boundingRect:z,viewBB:V,rfId:H}=ie(Rd,de),B=(e==null?void 0:e.width)??$d,S=(e==null?void 0:e.height)??Od,A=z.width/B,L=z.height/S,M=Math.max(A,L),h=M*B,N=M*S,y=I*M,k=z.x-(h-z.width)/2-y,R=z.y-(N-z.height)/2-y,E=h+y*2,O=N+y*2,D=`${zd}-${H}`,F=Y.useRef(0);F.current=M,Y.useEffect(()=>{if($.current){const p=me($.current),T=W=>{const{transform:U,d3Selection:Z,d3Zoom:J}=m.getState();if(W.sourceEvent.type!=="wheel"||!Z||!J)return;const ae=-W.sourceEvent.deltaY*(W.sourceEvent.deltaMode===1?.05:W.sourceEvent.deltaMode?1:.002)*x,re=U[2]*Math.pow(2,ae);J.scaleTo(Z,re)},P=W=>{const{transform:U,d3Selection:Z,d3Zoom:J,translateExtent:ae,width:re,height:te}=m.getState();if(W.sourceEvent.type!=="mousemove"||!Z||!J)return;const le=F.current*Math.max(1,U[2])*(_?-1:1),ne={x:U[0]-W.sourceEvent.movementX*le,y:U[1]-W.sourceEvent.movementY*le},q=[[0,0],[re,te]],ge=Ae.translate(ne.x,ne.y).scale(U[2]),Se=J.constrain()(ge,q,ae);J.transform(Z,Se)},j=yo().on("zoom",v?P:null).on("zoom.wheel",w?T:null);return p.call(j),()=>{p.on("zoom",null)}}},[v,w,_,x]);const G=g?p=>{const T=xe(p);g(p,{x:T[0],y:T[1]})}:void 0,b=f?(p,T)=>{const P=m.getState().nodeInternals.get(T);f(p,P)}:void 0;return X.createElement(Fn,{position:d,style:e,className:fe(["react-flow__minimap",t]),"data-testid":"rf__minimap"},X.createElement("svg",{width:B,height:S,viewBox:`${k} ${R} ${E} ${O}`,role:"img","aria-labelledby":D,ref:$,onClick:G},C&&X.createElement("title",{id:D},C),X.createElement(Td,{onClick:b,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:o,nodeStrokeWidth:i,nodeComponent:a}),X.createElement("path",{className:"react-flow__minimap-mask",d:`M${k-y},${R-y}h${E+y*2}v${O+y*2}h${-E-y*2}z
        M${V.x},${V.y}h${V.width}v${V.height}h${-V.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:l,pointerEvents:"none"})))}fi.displayName="MiniMap";var Dd=Y.memo(fi);function Pd(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},X.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ld(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},X.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Vd(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},X.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Fd(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Hd(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Nt=({children:e,className:t,...n})=>X.createElement("button",{type:"button",className:fe(["react-flow__controls-button",t]),...n},e);Nt.displayName="ControlButton";const Bd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),hi=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:u,children:l,position:d="bottom-left"})=>{const g=ue(),[f,v]=Y.useState(!1),{isInteractive:w,minZoomReached:C,maxZoomReached:_}=ie(Bd,de),{zoomIn:x,zoomOut:I,fitView:m}=Zn();if(Y.useEffect(()=>{v(!0)},[]),!f)return null;const $=()=>{x(),s==null||s()},z=()=>{I(),i==null||i()},V=()=>{m(o),a==null||a()},H=()=>{g.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),c==null||c(!w)};return X.createElement(Fn,{className:fe(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&X.createElement(X.Fragment,null,X.createElement(Nt,{onClick:$,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:_},X.createElement(Pd,null)),X.createElement(Nt,{onClick:z,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:C},X.createElement(Ld,null))),n&&X.createElement(Nt,{className:"react-flow__controls-fitview",onClick:V,title:"fit view","aria-label":"fit view"},X.createElement(Vd,null)),r&&X.createElement(Nt,{className:"react-flow__controls-interactive",onClick:H,title:"toggle interactivity","aria-label":"toggle interactivity"},w?X.createElement(Hd,null):X.createElement(Fd,null)),l)};hi.displayName="Controls";var jd=Y.memo(hi),ve;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ve||(ve={}));function Yd({color:e,dimensions:t,lineWidth:n}){return X.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Gd({color:e,radius:t}){return X.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Xd={[ve.Dots]:"#91919a",[ve.Lines]:"#eee",[ve.Cross]:"#e2e2e2"},Wd={[ve.Dots]:1,[ve.Lines]:1,[ve.Cross]:6},Ud=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function gi({id:e,variant:t=ve.Dots,gap:n=20,size:r,lineWidth:o=1,offset:s=2,color:i,style:a,className:c}){const u=Y.useRef(null),{transform:l,patternId:d}=ie(Ud,de),g=i||Xd[t],f=r||Wd[t],v=t===ve.Dots,w=t===ve.Cross,C=Array.isArray(n)?n:[n,n],_=[C[0]*l[2]||1,C[1]*l[2]||1],x=f*l[2],I=w?[x,x]:_,m=v?[x/s,x/s]:[I[0]/s,I[1]/s];return X.createElement("svg",{className:fe(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},X.createElement("pattern",{id:d+e,x:l[0]%_[0],y:l[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${m[0]},-${m[1]})`},v?X.createElement(Gd,{color:g,radius:x/s}):X.createElement(Yd,{dimensions:I,color:g,lineWidth:o})),X.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}gi.displayName="Background";var Zd=Y.memo(gi),oe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),be=oe((e,t)=>{var n=Object.defineProperty,r=(M,h,N)=>h in M?n(M,h,{enumerable:!0,configurable:!0,writable:!0,value:N}):M[h]=N,o=(M,h)=>()=>(h||M((h={exports:{}}).exports,h),h.exports),s=(M,h,N)=>r(M,typeof h!="symbol"?h+"":h,N),i=o((M,h)=>{var N="\0",y="\0",k="",R=class{constructor(b){s(this,"_isDirected",!0),s(this,"_isMultigraph",!1),s(this,"_isCompound",!1),s(this,"_label"),s(this,"_defaultNodeLabelFn",()=>{}),s(this,"_defaultEdgeLabelFn",()=>{}),s(this,"_nodes",{}),s(this,"_in",{}),s(this,"_preds",{}),s(this,"_out",{}),s(this,"_sucs",{}),s(this,"_edgeObjs",{}),s(this,"_edgeLabels",{}),s(this,"_nodeCount",0),s(this,"_edgeCount",0),s(this,"_parent"),s(this,"_children"),b&&(this._isDirected=Object.hasOwn(b,"directed")?b.directed:!0,this._isMultigraph=Object.hasOwn(b,"multigraph")?b.multigraph:!1,this._isCompound=Object.hasOwn(b,"compound")?b.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[y]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(b){return this._label=b,this}graph(){return this._label}setDefaultNodeLabel(b){return this._defaultNodeLabelFn=b,typeof b!="function"&&(this._defaultNodeLabelFn=()=>b),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var b=this;return this.nodes().filter(p=>Object.keys(b._in[p]).length===0)}sinks(){var b=this;return this.nodes().filter(p=>Object.keys(b._out[p]).length===0)}setNodes(b,p){var T=arguments,P=this;return b.forEach(function(j){T.length>1?P.setNode(j,p):P.setNode(j)}),this}setNode(b,p){return Object.hasOwn(this._nodes,b)?(arguments.length>1&&(this._nodes[b]=p),this):(this._nodes[b]=arguments.length>1?p:this._defaultNodeLabelFn(b),this._isCompound&&(this._parent[b]=y,this._children[b]={},this._children[y][b]=!0),this._in[b]={},this._preds[b]={},this._out[b]={},this._sucs[b]={},++this._nodeCount,this)}node(b){return this._nodes[b]}hasNode(b){return Object.hasOwn(this._nodes,b)}removeNode(b){var p=this;if(Object.hasOwn(this._nodes,b)){var T=P=>p.removeEdge(p._edgeObjs[P]);delete this._nodes[b],this._isCompound&&(this._removeFromParentsChildList(b),delete this._parent[b],this.children(b).forEach(function(P){p.setParent(P)}),delete this._children[b]),Object.keys(this._in[b]).forEach(T),delete this._in[b],delete this._preds[b],Object.keys(this._out[b]).forEach(T),delete this._out[b],delete this._sucs[b],--this._nodeCount}return this}setParent(b,p){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(p===void 0)p=y;else{p+="";for(var T=p;T!==void 0;T=this.parent(T))if(T===b)throw new Error("Setting "+p+" as parent of "+b+" would create a cycle");this.setNode(p)}return this.setNode(b),this._removeFromParentsChildList(b),this._parent[b]=p,this._children[p][b]=!0,this}_removeFromParentsChildList(b){delete this._children[this._parent[b]][b]}parent(b){if(this._isCompound){var p=this._parent[b];if(p!==y)return p}}children(b=y){if(this._isCompound){var p=this._children[b];if(p)return Object.keys(p)}else{if(b===y)return this.nodes();if(this.hasNode(b))return[]}}predecessors(b){var p=this._preds[b];if(p)return Object.keys(p)}successors(b){var p=this._sucs[b];if(p)return Object.keys(p)}neighbors(b){var p=this.predecessors(b);if(p){let P=new Set(p);for(var T of this.successors(b))P.add(T);return Array.from(P.values())}}isLeaf(b){var p;return this.isDirected()?p=this.successors(b):p=this.neighbors(b),p.length===0}filterNodes(b){var p=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});p.setGraph(this.graph());var T=this;Object.entries(this._nodes).forEach(function([W,U]){b(W)&&p.setNode(W,U)}),Object.values(this._edgeObjs).forEach(function(W){p.hasNode(W.v)&&p.hasNode(W.w)&&p.setEdge(W,T.edge(W))});var P={};function j(W){var U=T.parent(W);return U===void 0||p.hasNode(U)?(P[W]=U,U):U in P?P[U]:j(U)}return this._isCompound&&p.nodes().forEach(W=>p.setParent(W,j(W))),p}setDefaultEdgeLabel(b){return this._defaultEdgeLabelFn=b,typeof b!="function"&&(this._defaultEdgeLabelFn=()=>b),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(b,p){var T=this,P=arguments;return b.reduce(function(j,W){return P.length>1?T.setEdge(j,W,p):T.setEdge(j,W),W}),this}setEdge(){var b,p,T,P,j=!1,W=arguments[0];typeof W=="object"&&W!==null&&"v"in W?(b=W.v,p=W.w,T=W.name,arguments.length===2&&(P=arguments[1],j=!0)):(b=W,p=arguments[1],T=arguments[3],arguments.length>2&&(P=arguments[2],j=!0)),b=""+b,p=""+p,T!==void 0&&(T=""+T);var U=D(this._isDirected,b,p,T);if(Object.hasOwn(this._edgeLabels,U))return j&&(this._edgeLabels[U]=P),this;if(T!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(b),this.setNode(p),this._edgeLabels[U]=j?P:this._defaultEdgeLabelFn(b,p,T);var Z=F(this._isDirected,b,p,T);return b=Z.v,p=Z.w,Object.freeze(Z),this._edgeObjs[U]=Z,E(this._preds[p],b),E(this._sucs[b],p),this._in[p][U]=Z,this._out[b][U]=Z,this._edgeCount++,this}edge(b,p,T){var P=arguments.length===1?G(this._isDirected,arguments[0]):D(this._isDirected,b,p,T);return this._edgeLabels[P]}edgeAsObj(){let b=this.edge(...arguments);return typeof b!="object"?{label:b}:b}hasEdge(b,p,T){var P=arguments.length===1?G(this._isDirected,arguments[0]):D(this._isDirected,b,p,T);return Object.hasOwn(this._edgeLabels,P)}removeEdge(b,p,T){var P=arguments.length===1?G(this._isDirected,arguments[0]):D(this._isDirected,b,p,T),j=this._edgeObjs[P];return j&&(b=j.v,p=j.w,delete this._edgeLabels[P],delete this._edgeObjs[P],O(this._preds[p],b),O(this._sucs[b],p),delete this._in[p][P],delete this._out[b][P],this._edgeCount--),this}inEdges(b,p){return this.isDirected()?this.filterEdges(this._in[b],b,p):this.nodeEdges(b,p)}outEdges(b,p){return this.isDirected()?this.filterEdges(this._out[b],b,p):this.nodeEdges(b,p)}nodeEdges(b,p){if(b in this._nodes)return this.filterEdges({...this._in[b],...this._out[b]},b,p)}filterEdges(b,p,T){if(b){var P=Object.values(b);return T?P.filter(function(j){return j.v===p&&j.w===T||j.v===T&&j.w===p}):P}}};function E(b,p){b[p]?b[p]++:b[p]=1}function O(b,p){--b[p]||delete b[p]}function D(b,p,T,P){var j=""+p,W=""+T;if(!b&&j>W){var U=j;j=W,W=U}return j+k+W+k+(P===void 0?N:P)}function F(b,p,T,P){var j=""+p,W=""+T;if(!b&&j>W){var U=j;j=W,W=U}var Z={v:j,w:W};return P&&(Z.name=P),Z}function G(b,p){return D(b,p.v,p.w,p.name)}h.exports=R}),a=o((M,h)=>{h.exports="3.0.2"}),c=o((M,h)=>{h.exports={Graph:i(),version:a()}}),u=o((M,h)=>{var N=i();h.exports={write:y,read:E};function y(O){var D={options:{directed:O.isDirected(),multigraph:O.isMultigraph(),compound:O.isCompound()},nodes:k(O),edges:R(O)};return O.graph()!==void 0&&(D.value=structuredClone(O.graph())),D}function k(O){return O.nodes().map(function(D){var F=O.node(D),G=O.parent(D),b={v:D};return F!==void 0&&(b.value=F),G!==void 0&&(b.parent=G),b})}function R(O){return O.edges().map(function(D){var F=O.edge(D),G={v:D.v,w:D.w};return D.name!==void 0&&(G.name=D.name),F!==void 0&&(G.value=F),G})}function E(O){var D=new N(O.options).setGraph(O.value);return O.nodes.forEach(function(F){D.setNode(F.v,F.value),F.parent&&D.setParent(F.v,F.parent)}),O.edges.forEach(function(F){D.setEdge({v:F.v,w:F.w,name:F.name},F.value)}),D}}),l=o((M,h)=>{h.exports=y;var N=()=>1;function y(R,E,O,D){return k(R,String(E),O||N,D||function(F){return R.outEdges(F)})}function k(R,E,O,D){var F={},G=!0,b=0,p=R.nodes(),T=function(U){var Z=O(U);F[U.v].distance+Z<F[U.w].distance&&(F[U.w]={distance:F[U.v].distance+Z,predecessor:U.v},G=!0)},P=function(){p.forEach(function(U){D(U).forEach(function(Z){var J=Z.v===U?Z.v:Z.w,ae=J===Z.v?Z.w:Z.v;T({v:J,w:ae})})})};p.forEach(function(U){var Z=U===E?0:Number.POSITIVE_INFINITY;F[U]={distance:Z}});for(var j=p.length,W=1;W<j&&(G=!1,b++,P(),!!G);W++);if(b===j-1&&(G=!1,P(),G))throw new Error("The graph contains a negative weight cycle");return F}}),d=o((M,h)=>{h.exports=N;function N(y){var k={},R=[],E;function O(D){Object.hasOwn(k,D)||(k[D]=!0,E.push(D),y.successors(D).forEach(O),y.predecessors(D).forEach(O))}return y.nodes().forEach(function(D){E=[],O(D),E.length&&R.push(E)}),R}}),g=o((M,h)=>{var N=class{constructor(){s(this,"_arr",[]),s(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(y){return y.key})}has(y){return Object.hasOwn(this._keyIndices,y)}priority(y){var k=this._keyIndices[y];if(k!==void 0)return this._arr[k].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(y,k){var R=this._keyIndices;if(y=String(y),!Object.hasOwn(R,y)){var E=this._arr,O=E.length;return R[y]=O,E.push({key:y,priority:k}),this._decrease(O),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var y=this._arr.pop();return delete this._keyIndices[y.key],this._heapify(0),y.key}decrease(y,k){var R=this._keyIndices[y];if(k>this._arr[R].priority)throw new Error("New priority is greater than current priority. Key: "+y+" Old: "+this._arr[R].priority+" New: "+k);this._arr[R].priority=k,this._decrease(R)}_heapify(y){var k=this._arr,R=2*y,E=R+1,O=y;R<k.length&&(O=k[R].priority<k[O].priority?R:O,E<k.length&&(O=k[E].priority<k[O].priority?E:O),O!==y&&(this._swap(y,O),this._heapify(O)))}_decrease(y){for(var k=this._arr,R=k[y].priority,E;y!==0&&(E=y>>1,!(k[E].priority<R));)this._swap(y,E),y=E}_swap(y,k){var R=this._arr,E=this._keyIndices,O=R[y],D=R[k];R[y]=D,R[k]=O,E[D.key]=y,E[O.key]=k}};h.exports=N}),f=o((M,h)=>{var N=g();h.exports=k;var y=()=>1;function k(E,O,D,F){var G=function(b){return E.outEdges(b)};return R(E,String(O),D||y,F||G)}function R(E,O,D,F){var G={},b=new N,p,T,P=function(j){var W=j.v!==p?j.v:j.w,U=G[W],Z=D(j),J=T.distance+Z;if(Z<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+j+" Weight: "+Z);J<U.distance&&(U.distance=J,U.predecessor=p,b.decrease(W,J))};for(E.nodes().forEach(function(j){var W=j===O?0:Number.POSITIVE_INFINITY;G[j]={distance:W},b.add(j,W)});b.size()>0&&(p=b.removeMin(),T=G[p],T.distance!==Number.POSITIVE_INFINITY);)F(p).forEach(P);return G}}),v=o((M,h)=>{var N=f();h.exports=y;function y(k,R,E){return k.nodes().reduce(function(O,D){return O[D]=N(k,D,R,E),O},{})}}),w=o((M,h)=>{h.exports=N;function N(k,R,E){if(k[R].predecessor!==void 0)throw new Error("Invalid source vertex");if(k[E].predecessor===void 0&&E!==R)throw new Error("Invalid destination vertex");return{weight:k[E].distance,path:y(k,R,E)}}function y(k,R,E){for(var O=[],D=E;D!==R;)O.push(D),D=k[D].predecessor;return O.push(R),O.reverse()}}),C=o((M,h)=>{h.exports=N;function N(y){var k=0,R=[],E={},O=[];function D(F){var G=E[F]={onStack:!0,lowlink:k,index:k++};if(R.push(F),y.successors(F).forEach(function(T){Object.hasOwn(E,T)?E[T].onStack&&(G.lowlink=Math.min(G.lowlink,E[T].index)):(D(T),G.lowlink=Math.min(G.lowlink,E[T].lowlink))}),G.lowlink===G.index){var b=[],p;do p=R.pop(),E[p].onStack=!1,b.push(p);while(F!==p);O.push(b)}}return y.nodes().forEach(function(F){Object.hasOwn(E,F)||D(F)}),O}}),_=o((M,h)=>{var N=C();h.exports=y;function y(k){return N(k).filter(function(R){return R.length>1||R.length===1&&k.hasEdge(R[0],R[0])})}}),x=o((M,h)=>{h.exports=y;var N=()=>1;function y(R,E,O){return k(R,E||N,O||function(D){return R.outEdges(D)})}function k(R,E,O){var D={},F=R.nodes();return F.forEach(function(G){D[G]={},D[G][G]={distance:0},F.forEach(function(b){G!==b&&(D[G][b]={distance:Number.POSITIVE_INFINITY})}),O(G).forEach(function(b){var p=b.v===G?b.w:b.v,T=E(b);D[G][p]={distance:T,predecessor:G}})}),F.forEach(function(G){var b=D[G];F.forEach(function(p){var T=D[p];F.forEach(function(P){var j=T[G],W=b[P],U=T[P],Z=j.distance+W.distance;Z<U.distance&&(U.distance=Z,U.predecessor=W.predecessor)})})}),D}}),I=o((M,h)=>{function N(k){var R={},E={},O=[];function D(F){if(Object.hasOwn(E,F))throw new y;Object.hasOwn(R,F)||(E[F]=!0,R[F]=!0,k.predecessors(F).forEach(D),delete E[F],O.push(F))}if(k.sinks().forEach(D),Object.keys(R).length!==k.nodeCount())throw new y;return O}var y=class extends Error{constructor(){super(...arguments)}};h.exports=N,N.CycleException=y}),m=o((M,h)=>{var N=I();h.exports=y;function y(k){try{N(k)}catch(R){if(R instanceof N.CycleException)return!1;throw R}return!0}}),$=o((M,h)=>{h.exports=N;function N(k,R,E,O,D){Array.isArray(R)||(R=[R]);var F=(k.isDirected()?k.successors:k.neighbors).bind(k),G={};return R.forEach(function(b){if(!k.hasNode(b))throw new Error("Graph does not have node: "+b);D=y(k,b,E==="post",G,F,O,D)}),D}function y(k,R,E,O,D,F,G){return Object.hasOwn(O,R)||(O[R]=!0,E||(G=F(G,R)),D(R).forEach(function(b){G=y(k,b,E,O,D,F,G)}),E&&(G=F(G,R))),G}}),z=o((M,h)=>{var N=$();h.exports=y;function y(k,R,E){return N(k,R,E,function(O,D){return O.push(D),O},[])}}),V=o((M,h)=>{var N=z();h.exports=y;function y(k,R){return N(k,R,"post")}}),H=o((M,h)=>{var N=z();h.exports=y;function y(k,R){return N(k,R,"pre")}}),B=o((M,h)=>{var N=i(),y=g();h.exports=k;function k(R,E){var O=new N,D={},F=new y,G;function b(T){var P=T.v===G?T.w:T.v,j=F.priority(P);if(j!==void 0){var W=E(T);W<j&&(D[P]=G,F.decrease(P,W))}}if(R.nodeCount()===0)return O;R.nodes().forEach(function(T){F.add(T,Number.POSITIVE_INFINITY),O.setNode(T)}),F.decrease(R.nodes()[0],0);for(var p=!1;F.size()>0;){if(G=F.removeMin(),Object.hasOwn(D,G))O.setEdge(G,D[G]);else{if(p)throw new Error("Input graph is not connected: "+R);p=!0}R.nodeEdges(G).forEach(b)}return O}}),S=o((M,h)=>{var N=f(),y=l();h.exports=k;function k(E,O,D,F){return R(E,O,D,F||function(G){return E.outEdges(G)})}function R(E,O,D,F){if(D===void 0)return N(E,O,D,F);for(var G=!1,b=E.nodes(),p=0;p<b.length;p++){for(var T=F(b[p]),P=0;P<T.length;P++){var j=T[P],W=j.v===b[p]?j.v:j.w,U=W===j.v?j.w:j.v;D({v:W,w:U})<0&&(G=!0)}if(G)return y(E,O,D,F)}return N(E,O,D,F)}}),A=o((M,h)=>{h.exports={bellmanFord:l(),components:d(),dijkstra:f(),dijkstraAll:v(),extractPath:w(),findCycles:_(),floydWarshall:x(),isAcyclic:m(),postorder:V(),preorder:H(),prim:B(),shortestPaths:S(),reduce:$(),tarjan:C(),topsort:I()}}),L=c();t.exports={Graph:L.Graph,json:u(),alg:A(),version:L.version}}),qd=oe((e,t)=>{var n=class{constructor(){let s={};s._next=s._prev=s,this._sentinel=s}dequeue(){let s=this._sentinel,i=s._prev;if(i!==s)return r(i),i}enqueue(s){let i=this._sentinel;s._prev&&s._next&&r(s),s._next=i._next,i._next._prev=s,i._next=s,s._prev=i}toString(){let s=[],i=this._sentinel,a=i._prev;for(;a!==i;)s.push(JSON.stringify(a,o)),a=a._prev;return"["+s.join(", ")+"]"}};function r(s){s._prev._next=s._next,s._next._prev=s._prev,delete s._next,delete s._prev}function o(s,i){if(s!=="_next"&&s!=="_prev")return i}t.exports=n}),Kd=oe((e,t)=>{var n=be().Graph,r=qd();t.exports=s;var o=()=>1;function s(d,g){if(d.nodeCount()<=1)return[];let f=c(d,g||o);return i(f.graph,f.buckets,f.zeroIdx).flatMap(v=>d.outEdges(v.v,v.w))}function i(d,g,f){let v=[],w=g[g.length-1],C=g[0],_;for(;d.nodeCount();){for(;_=C.dequeue();)a(d,g,f,_);for(;_=w.dequeue();)a(d,g,f,_);if(d.nodeCount()){for(let x=g.length-2;x>0;--x)if(_=g[x].dequeue(),_){v=v.concat(a(d,g,f,_,!0));break}}}return v}function a(d,g,f,v,w){let C=w?[]:void 0;return d.inEdges(v.v).forEach(_=>{let x=d.edge(_),I=d.node(_.v);w&&C.push({v:_.v,w:_.w}),I.out-=x,u(g,f,I)}),d.outEdges(v.v).forEach(_=>{let x=d.edge(_),I=_.w,m=d.node(I);m.in-=x,u(g,f,m)}),d.removeNode(v.v),C}function c(d,g){let f=new n,v=0,w=0;d.nodes().forEach(x=>{f.setNode(x,{v:x,in:0,out:0})}),d.edges().forEach(x=>{let I=f.edge(x.v,x.w)||0,m=g(x),$=I+m;f.setEdge(x.v,x.w,$),w=Math.max(w,f.node(x.v).out+=m),v=Math.max(v,f.node(x.w).in+=m)});let C=l(w+v+3).map(()=>new r),_=v+1;return f.nodes().forEach(x=>{u(C,_,f.node(x))}),{graph:f,buckets:C,zeroIdx:_}}function u(d,g,f){f.out?f.in?d[f.out-f.in+g].enqueue(f):d[d.length-1].enqueue(f):d[0].enqueue(f)}function l(d){let g=[];for(let f=0;f<d;f++)g.push(f);return g}}),ce=oe((e,t)=>{var n=be().Graph;t.exports={addBorderNode:g,addDummyNode:r,applyWithChunking:w,asNonCompoundGraph:s,buildLayerMatrix:u,intersectRect:c,mapValues:H,maxRank:C,normalizeRanks:l,notime:I,partition:_,pick:V,predecessorWeights:a,range:z,removeEmptyRanks:d,simplify:o,successorWeights:i,time:x,uniqueId:$,zipObject:B};function r(S,A,L,M){for(var h=M;S.hasNode(h);)h=$(M);return L.dummy=A,S.setNode(h,L),h}function o(S){let A=new n().setGraph(S.graph());return S.nodes().forEach(L=>A.setNode(L,S.node(L))),S.edges().forEach(L=>{let M=A.edge(L.v,L.w)||{weight:0,minlen:1},h=S.edge(L);A.setEdge(L.v,L.w,{weight:M.weight+h.weight,minlen:Math.max(M.minlen,h.minlen)})}),A}function s(S){let A=new n({multigraph:S.isMultigraph()}).setGraph(S.graph());return S.nodes().forEach(L=>{S.children(L).length||A.setNode(L,S.node(L))}),S.edges().forEach(L=>{A.setEdge(L,S.edge(L))}),A}function i(S){let A=S.nodes().map(L=>{let M={};return S.outEdges(L).forEach(h=>{M[h.w]=(M[h.w]||0)+S.edge(h).weight}),M});return B(S.nodes(),A)}function a(S){let A=S.nodes().map(L=>{let M={};return S.inEdges(L).forEach(h=>{M[h.v]=(M[h.v]||0)+S.edge(h).weight}),M});return B(S.nodes(),A)}function c(S,A){let L=S.x,M=S.y,h=A.x-L,N=A.y-M,y=S.width/2,k=S.height/2;if(!h&&!N)throw new Error("Not possible to find intersection inside of the rectangle");let R,E;return Math.abs(N)*y>Math.abs(h)*k?(N<0&&(k=-k),R=k*h/N,E=k):(h<0&&(y=-y),R=y,E=y*N/h),{x:L+R,y:M+E}}function u(S){let A=z(C(S)+1).map(()=>[]);return S.nodes().forEach(L=>{let M=S.node(L),h=M.rank;h!==void 0&&(A[h][M.order]=L)}),A}function l(S){let A=S.nodes().map(M=>{let h=S.node(M).rank;return h===void 0?Number.MAX_VALUE:h}),L=w(Math.min,A);S.nodes().forEach(M=>{let h=S.node(M);Object.hasOwn(h,"rank")&&(h.rank-=L)})}function d(S){let A=S.nodes().map(y=>S.node(y).rank).filter(y=>y!==void 0),L=w(Math.min,A),M=[];S.nodes().forEach(y=>{let k=S.node(y).rank-L;M[k]||(M[k]=[]),M[k].push(y)});let h=0,N=S.graph().nodeRankFactor;Array.from(M).forEach((y,k)=>{y===void 0&&k%N!==0?--h:y!==void 0&&h&&y.forEach(R=>S.node(R).rank+=h)})}function g(S,A,L,M){let h={width:0,height:0};return arguments.length>=4&&(h.rank=L,h.order=M),r(S,"border",h,A)}function f(S,A=v){let L=[];for(let M=0;M<S.length;M+=A){let h=S.slice(M,M+A);L.push(h)}return L}var v=65535;function w(S,A){if(A.length>v){let L=f(A);return S.apply(null,L.map(M=>S.apply(null,M)))}else return S.apply(null,A)}function C(S){let A=S.nodes().map(L=>{let M=S.node(L).rank;return M===void 0?Number.MIN_VALUE:M});return w(Math.max,A)}function _(S,A){let L={lhs:[],rhs:[]};return S.forEach(M=>{A(M)?L.lhs.push(M):L.rhs.push(M)}),L}function x(S,A){let L=Date.now();try{return A()}finally{console.log(S+" time: "+(Date.now()-L)+"ms")}}function I(S,A){return A()}var m=0;function $(S){var A=++m;return S+(""+A)}function z(S,A,L=1){A==null&&(A=S,S=0);let M=N=>N<A;L<0&&(M=N=>A<N);let h=[];for(let N=S;M(N);N+=L)h.push(N);return h}function V(S,A){let L={};for(let M of A)S[M]!==void 0&&(L[M]=S[M]);return L}function H(S,A){let L=A;return typeof A=="string"&&(L=M=>M[A]),Object.entries(S).reduce((M,[h,N])=>(M[h]=L(N,h),M),{})}function B(S,A){return S.reduce((L,M,h)=>(L[M]=A[h],L),{})}}),Qd=oe((e,t)=>{var n=Kd(),r=ce().uniqueId;t.exports={run:o,undo:i};function o(a){(a.graph().acyclicer==="greedy"?n(a,c(a)):s(a)).forEach(u=>{let l=a.edge(u);a.removeEdge(u),l.forwardName=u.name,l.reversed=!0,a.setEdge(u.w,u.v,l,r("rev"))});function c(u){return l=>u.edge(l).weight}}function s(a){let c=[],u={},l={};function d(g){Object.hasOwn(l,g)||(l[g]=!0,u[g]=!0,a.outEdges(g).forEach(f=>{Object.hasOwn(u,f.w)?c.push(f):d(f.w)}),delete u[g])}return a.nodes().forEach(d),c}function i(a){a.edges().forEach(c=>{let u=a.edge(c);if(u.reversed){a.removeEdge(c);let l=u.forwardName;delete u.reversed,delete u.forwardName,a.setEdge(c.w,c.v,u,l)}})}}),Jd=oe((e,t)=>{var n=ce();t.exports={run:r,undo:s};function r(i){i.graph().dummyChains=[],i.edges().forEach(a=>o(i,a))}function o(i,a){let c=a.v,u=i.node(c).rank,l=a.w,d=i.node(l).rank,g=a.name,f=i.edge(a),v=f.labelRank;if(d===u+1)return;i.removeEdge(a);let w,C,_;for(_=0,++u;u<d;++_,++u)f.points=[],C={width:0,height:0,edgeLabel:f,edgeObj:a,rank:u},w=n.addDummyNode(i,"edge",C,"_d"),u===v&&(C.width=f.width,C.height=f.height,C.dummy="edge-label",C.labelpos=f.labelpos),i.setEdge(c,w,{weight:f.weight},g),_===0&&i.graph().dummyChains.push(w),c=w;i.setEdge(c,l,{weight:f.weight},g)}function s(i){i.graph().dummyChains.forEach(a=>{let c=i.node(a),u=c.edgeLabel,l;for(i.setEdge(c.edgeObj,u);c.dummy;)l=i.successors(a)[0],i.removeNode(a),u.points.push({x:c.x,y:c.y}),c.dummy==="edge-label"&&(u.x=c.x,u.y=c.y,u.width=c.width,u.height=c.height),a=l,c=i.node(a)})}}),Qt=oe((e,t)=>{var{applyWithChunking:n}=ce();t.exports={longestPath:r,slack:o};function r(s){var i={};function a(c){var u=s.node(c);if(Object.hasOwn(i,c))return u.rank;i[c]=!0;let l=s.outEdges(c).map(g=>g==null?Number.POSITIVE_INFINITY:a(g.w)-s.edge(g).minlen);var d=n(Math.min,l);return d===Number.POSITIVE_INFINITY&&(d=0),u.rank=d}s.sources().forEach(a)}function o(s,i){return s.node(i.w).rank-s.node(i.v).rank-s.edge(i).minlen}}),pi=oe((e,t)=>{var n=be().Graph,r=Qt().slack;t.exports=o;function o(c){var u=new n({directed:!1}),l=c.nodes()[0],d=c.nodeCount();u.setNode(l,{});for(var g,f;s(u,c)<d;)g=i(u,c),f=u.hasNode(g.v)?r(c,g):-r(c,g),a(u,c,f);return u}function s(c,u){function l(d){u.nodeEdges(d).forEach(g=>{var f=g.v,v=d===f?g.w:f;!c.hasNode(v)&&!r(u,g)&&(c.setNode(v,{}),c.setEdge(d,v,{}),l(v))})}return c.nodes().forEach(l),c.nodeCount()}function i(c,u){return u.edges().reduce((l,d)=>{let g=Number.POSITIVE_INFINITY;return c.hasNode(d.v)!==c.hasNode(d.w)&&(g=r(u,d)),g<l[0]?[g,d]:l},[Number.POSITIVE_INFINITY,null])[1]}function a(c,u,l){c.nodes().forEach(d=>u.node(d).rank+=l)}}),ef=oe((e,t)=>{var n=pi(),r=Qt().slack,o=Qt().longestPath,s=be().alg.preorder,i=be().alg.postorder,a=ce().simplify;t.exports=c,c.initLowLimValues=g,c.initCutValues=u,c.calcCutValue=d,c.leaveEdge=v,c.enterEdge=w,c.exchangeEdges=C;function c(m){m=a(m),o(m);var $=n(m);g($),u($,m);for(var z,V;z=v($);)V=w($,m,z),C($,m,z,V)}function u(m,$){var z=i(m,m.nodes());z=z.slice(0,z.length-1),z.forEach(V=>l(m,$,V))}function l(m,$,z){var V=m.node(z),H=V.parent;m.edge(z,H).cutvalue=d(m,$,z)}function d(m,$,z){var V=m.node(z),H=V.parent,B=!0,S=$.edge(z,H),A=0;return S||(B=!1,S=$.edge(H,z)),A=S.weight,$.nodeEdges(z).forEach(L=>{var M=L.v===z,h=M?L.w:L.v;if(h!==H){var N=M===B,y=$.edge(L).weight;if(A+=N?y:-y,x(m,z,h)){var k=m.edge(z,h).cutvalue;A+=N?-k:k}}}),A}function g(m,$){arguments.length<2&&($=m.nodes()[0]),f(m,{},1,$)}function f(m,$,z,V,H){var B=z,S=m.node(V);return $[V]=!0,m.neighbors(V).forEach(A=>{Object.hasOwn($,A)||(z=f(m,$,z,A,V))}),S.low=B,S.lim=z++,H?S.parent=H:delete S.parent,z}function v(m){return m.edges().find($=>m.edge($).cutvalue<0)}function w(m,$,z){var V=z.v,H=z.w;$.hasEdge(V,H)||(V=z.w,H=z.v);var B=m.node(V),S=m.node(H),A=B,L=!1;B.lim>S.lim&&(A=S,L=!0);var M=$.edges().filter(h=>L===I(m,m.node(h.v),A)&&L!==I(m,m.node(h.w),A));return M.reduce((h,N)=>r($,N)<r($,h)?N:h)}function C(m,$,z,V){var H=z.v,B=z.w;m.removeEdge(H,B),m.setEdge(V.v,V.w,{}),g(m),u(m,$),_(m,$)}function _(m,$){var z=m.nodes().find(H=>!$.node(H).parent),V=s(m,z);V=V.slice(1),V.forEach(H=>{var B=m.node(H).parent,S=$.edge(H,B),A=!1;S||(S=$.edge(B,H),A=!0),$.node(H).rank=$.node(B).rank+(A?S.minlen:-S.minlen)})}function x(m,$,z){return m.hasEdge($,z)}function I(m,$,z){return z.low<=$.lim&&$.lim<=z.lim}}),tf=oe((e,t)=>{var n=Qt(),r=n.longestPath,o=pi(),s=ef();t.exports=i;function i(l){var d=l.graph().ranker;if(d instanceof Function)return d(l);switch(l.graph().ranker){case"network-simplex":u(l);break;case"tight-tree":c(l);break;case"longest-path":a(l);break;case"none":break;default:u(l)}}var a=r;function c(l){r(l),o(l)}function u(l){s(l)}}),nf=oe((e,t)=>{t.exports=n;function n(s){let i=o(s);s.graph().dummyChains.forEach(a=>{let c=s.node(a),u=c.edgeObj,l=r(s,i,u.v,u.w),d=l.path,g=l.lca,f=0,v=d[f],w=!0;for(;a!==u.w;){if(c=s.node(a),w){for(;(v=d[f])!==g&&s.node(v).maxRank<c.rank;)f++;v===g&&(w=!1)}if(!w){for(;f<d.length-1&&s.node(v=d[f+1]).minRank<=c.rank;)f++;v=d[f]}s.setParent(a,v),a=s.successors(a)[0]}})}function r(s,i,a,c){let u=[],l=[],d=Math.min(i[a].low,i[c].low),g=Math.max(i[a].lim,i[c].lim),f,v;f=a;do f=s.parent(f),u.push(f);while(f&&(i[f].low>d||g>i[f].lim));for(v=f,f=c;(f=s.parent(f))!==v;)l.push(f);return{path:u.concat(l.reverse()),lca:v}}function o(s){let i={},a=0;function c(u){let l=a;s.children(u).forEach(c),i[u]={low:l,lim:a++}}return s.children().forEach(c),i}}),rf=oe((e,t)=>{var n=ce();t.exports={run:r,cleanup:a};function r(c){let u=n.addDummyNode(c,"root",{},"_root"),l=s(c),d=Object.values(l),g=n.applyWithChunking(Math.max,d)-1,f=2*g+1;c.graph().nestingRoot=u,c.edges().forEach(w=>c.edge(w).minlen*=f);let v=i(c)+1;c.children().forEach(w=>o(c,u,f,v,g,l,w)),c.graph().nodeRankFactor=f}function o(c,u,l,d,g,f,v){let w=c.children(v);if(!w.length){v!==u&&c.setEdge(u,v,{weight:0,minlen:l});return}let C=n.addBorderNode(c,"_bt"),_=n.addBorderNode(c,"_bb"),x=c.node(v);c.setParent(C,v),x.borderTop=C,c.setParent(_,v),x.borderBottom=_,w.forEach(I=>{o(c,u,l,d,g,f,I);let m=c.node(I),$=m.borderTop?m.borderTop:I,z=m.borderBottom?m.borderBottom:I,V=m.borderTop?d:2*d,H=$!==z?1:g-f[v]+1;c.setEdge(C,$,{weight:V,minlen:H,nestingEdge:!0}),c.setEdge(z,_,{weight:V,minlen:H,nestingEdge:!0})}),c.parent(v)||c.setEdge(u,C,{weight:0,minlen:g+f[v]})}function s(c){var u={};function l(d,g){var f=c.children(d);f&&f.length&&f.forEach(v=>l(v,g+1)),u[d]=g}return c.children().forEach(d=>l(d,1)),u}function i(c){return c.edges().reduce((u,l)=>u+c.edge(l).weight,0)}function a(c){var u=c.graph();c.removeNode(u.nestingRoot),delete u.nestingRoot,c.edges().forEach(l=>{var d=c.edge(l);d.nestingEdge&&c.removeEdge(l)})}}),of=oe((e,t)=>{var n=ce();t.exports=r;function r(s){function i(a){let c=s.children(a),u=s.node(a);if(c.length&&c.forEach(i),Object.hasOwn(u,"minRank")){u.borderLeft=[],u.borderRight=[];for(let l=u.minRank,d=u.maxRank+1;l<d;++l)o(s,"borderLeft","_bl",a,u,l),o(s,"borderRight","_br",a,u,l)}}s.children().forEach(i)}function o(s,i,a,c,u,l){let d={width:0,height:0,rank:l,borderType:i},g=u[i][l-1],f=n.addDummyNode(s,"border",d,a);u[i][l]=f,s.setParent(f,c),g&&s.setEdge(g,f,{weight:1})}}),sf=oe((e,t)=>{t.exports={adjust:n,undo:r};function n(l){let d=l.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&o(l)}function r(l){let d=l.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&i(l),(d==="lr"||d==="rl")&&(c(l),o(l))}function o(l){l.nodes().forEach(d=>s(l.node(d))),l.edges().forEach(d=>s(l.edge(d)))}function s(l){let d=l.width;l.width=l.height,l.height=d}function i(l){l.nodes().forEach(d=>a(l.node(d))),l.edges().forEach(d=>{let g=l.edge(d);g.points.forEach(a),Object.hasOwn(g,"y")&&a(g)})}function a(l){l.y=-l.y}function c(l){l.nodes().forEach(d=>u(l.node(d))),l.edges().forEach(d=>{let g=l.edge(d);g.points.forEach(u),Object.hasOwn(g,"x")&&u(g)})}function u(l){let d=l.x;l.x=l.y,l.y=d}}),af=oe((e,t)=>{var n=ce();t.exports=r;function r(o){let s={},i=o.nodes().filter(d=>!o.children(d).length),a=i.map(d=>o.node(d).rank),c=n.applyWithChunking(Math.max,a),u=n.range(c+1).map(()=>[]);function l(d){if(s[d])return;s[d]=!0;let g=o.node(d);u[g.rank].push(d),o.successors(d).forEach(l)}return i.sort((d,g)=>o.node(d).rank-o.node(g).rank).forEach(l),u}}),cf=oe((e,t)=>{var n=ce().zipObject;t.exports=r;function r(s,i){let a=0;for(let c=1;c<i.length;++c)a+=o(s,i[c-1],i[c]);return a}function o(s,i,a){let c=n(a,a.map((v,w)=>w)),u=i.flatMap(v=>s.outEdges(v).map(w=>({pos:c[w.w],weight:s.edge(w).weight})).sort((w,C)=>w.pos-C.pos)),l=1;for(;l<a.length;)l<<=1;let d=2*l-1;l-=1;let g=new Array(d).fill(0),f=0;return u.forEach(v=>{let w=v.pos+l;g[w]+=v.weight;let C=0;for(;w>0;)w%2&&(C+=g[w+1]),w=w-1>>1,g[w]+=v.weight;f+=v.weight*C}),f}}),lf=oe((e,t)=>{t.exports=n;function n(r,o=[]){return o.map(s=>{let i=r.inEdges(s);if(i.length){let a=i.reduce((c,u)=>{let l=r.edge(u),d=r.node(u.v);return{sum:c.sum+l.weight*d.order,weight:c.weight+l.weight}},{sum:0,weight:0});return{v:s,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:s}})}}),uf=oe((e,t)=>{var n=ce();t.exports=r;function r(i,a){let c={};i.forEach((l,d)=>{let g=c[l.v]={indegree:0,in:[],out:[],vs:[l.v],i:d};l.barycenter!==void 0&&(g.barycenter=l.barycenter,g.weight=l.weight)}),a.edges().forEach(l=>{let d=c[l.v],g=c[l.w];d!==void 0&&g!==void 0&&(g.indegree++,d.out.push(c[l.w]))});let u=Object.values(c).filter(l=>!l.indegree);return o(u)}function o(i){let a=[];function c(l){return d=>{d.merged||(d.barycenter===void 0||l.barycenter===void 0||d.barycenter>=l.barycenter)&&s(l,d)}}function u(l){return d=>{d.in.push(l),--d.indegree===0&&i.push(d)}}for(;i.length;){let l=i.pop();a.push(l),l.in.reverse().forEach(c(l)),l.out.forEach(u(l))}return a.filter(l=>!l.merged).map(l=>n.pick(l,["vs","i","barycenter","weight"]))}function s(i,a){let c=0,u=0;i.weight&&(c+=i.barycenter*i.weight,u+=i.weight),a.weight&&(c+=a.barycenter*a.weight,u+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=c/u,i.weight=u,i.i=Math.min(a.i,i.i),a.merged=!0}}),df=oe((e,t)=>{var n=ce();t.exports=r;function r(i,a){let c=n.partition(i,C=>Object.hasOwn(C,"barycenter")),u=c.lhs,l=c.rhs.sort((C,_)=>_.i-C.i),d=[],g=0,f=0,v=0;u.sort(s(!!a)),v=o(d,l,v),u.forEach(C=>{v+=C.vs.length,d.push(C.vs),g+=C.barycenter*C.weight,f+=C.weight,v=o(d,l,v)});let w={vs:d.flat(!0)};return f&&(w.barycenter=g/f,w.weight=f),w}function o(i,a,c){let u;for(;a.length&&(u=a[a.length-1]).i<=c;)a.pop(),i.push(u.vs),c++;return c}function s(i){return(a,c)=>a.barycenter<c.barycenter?-1:a.barycenter>c.barycenter?1:i?c.i-a.i:a.i-c.i}}),ff=oe((e,t)=>{var n=lf(),r=uf(),o=df();t.exports=s;function s(c,u,l,d){let g=c.children(u),f=c.node(u),v=f?f.borderLeft:void 0,w=f?f.borderRight:void 0,C={};v&&(g=g.filter(m=>m!==v&&m!==w));let _=n(c,g);_.forEach(m=>{if(c.children(m.v).length){let $=s(c,m.v,l,d);C[m.v]=$,Object.hasOwn($,"barycenter")&&a(m,$)}});let x=r(_,l);i(x,C);let I=o(x,d);if(v&&(I.vs=[v,I.vs,w].flat(!0),c.predecessors(v).length)){let m=c.node(c.predecessors(v)[0]),$=c.node(c.predecessors(w)[0]);Object.hasOwn(I,"barycenter")||(I.barycenter=0,I.weight=0),I.barycenter=(I.barycenter*I.weight+m.order+$.order)/(I.weight+2),I.weight+=2}return I}function i(c,u){c.forEach(l=>{l.vs=l.vs.flatMap(d=>u[d]?u[d].vs:d)})}function a(c,u){c.barycenter!==void 0?(c.barycenter=(c.barycenter*c.weight+u.barycenter*u.weight)/(c.weight+u.weight),c.weight+=u.weight):(c.barycenter=u.barycenter,c.weight=u.weight)}}),hf=oe((e,t)=>{var n=be().Graph,r=ce();t.exports=o;function o(i,a,c,u){u||(u=i.nodes());let l=s(i),d=new n({compound:!0}).setGraph({root:l}).setDefaultNodeLabel(g=>i.node(g));return u.forEach(g=>{let f=i.node(g),v=i.parent(g);(f.rank===a||f.minRank<=a&&a<=f.maxRank)&&(d.setNode(g),d.setParent(g,v||l),i[c](g).forEach(w=>{let C=w.v===g?w.w:w.v,_=d.edge(C,g),x=_!==void 0?_.weight:0;d.setEdge(C,g,{weight:i.edge(w).weight+x})}),Object.hasOwn(f,"minRank")&&d.setNode(g,{borderLeft:f.borderLeft[a],borderRight:f.borderRight[a]}))}),d}function s(i){for(var a;i.hasNode(a=r.uniqueId("_root")););return a}}),gf=oe((e,t)=>{t.exports=n;function n(r,o,s){let i={},a;s.forEach(c=>{let u=r.parent(c),l,d;for(;u;){if(l=r.parent(u),l?(d=i[l],i[l]=u):(d=a,a=u),d&&d!==u){o.setEdge(d,u);return}u=l}})}}),pf=oe((e,t)=>{var n=af(),r=cf(),o=ff(),s=hf(),i=gf(),a=be().Graph,c=ce();t.exports=u;function u(f,v={}){if(typeof v.customOrder=="function"){v.customOrder(f,u);return}let w=c.maxRank(f),C=l(f,c.range(1,w+1),"inEdges"),_=l(f,c.range(w-1,-1,-1),"outEdges"),x=n(f);if(g(f,x),v.disableOptimalOrderHeuristic)return;let I=Number.POSITIVE_INFINITY,m,$=v.constraints||[];for(let z=0,V=0;V<4;++z,++V){d(z%2?C:_,z%4>=2,$),x=c.buildLayerMatrix(f);let H=r(f,x);H<I?(V=0,m=Object.assign({},x),I=H):H===I&&(m=structuredClone(x))}g(f,m)}function l(f,v,w){let C=new Map,_=(x,I)=>{C.has(x)||C.set(x,[]),C.get(x).push(I)};for(let x of f.nodes()){let I=f.node(x);if(typeof I.rank=="number"&&_(I.rank,x),typeof I.minRank=="number"&&typeof I.maxRank=="number")for(let m=I.minRank;m<=I.maxRank;m++)m!==I.rank&&_(m,x)}return v.map(function(x){return s(f,x,w,C.get(x)||[])})}function d(f,v,w){let C=new a;f.forEach(function(_){w.forEach(m=>C.setEdge(m.left,m.right));let x=_.graph().root,I=o(_,x,C,v);I.vs.forEach((m,$)=>_.node(m).order=$),i(_,C,I.vs)})}function g(f,v){Object.values(v).forEach(w=>w.forEach((C,_)=>f.node(C).order=_))}}),mf=oe((e,t)=>{var n=be().Graph,r=ce();t.exports={positionX:w,findType1Conflicts:o,findType2Conflicts:s,addConflict:a,hasConflict:c,verticalAlignment:u,horizontalCompaction:l,alignCoordinates:f,findSmallestWidthAlignment:g,balance:v};function o(x,I){let m={};function $(z,V){let H=0,B=0,S=z.length,A=V[V.length-1];return V.forEach((L,M)=>{let h=i(x,L),N=h?x.node(h).order:S;(h||L===A)&&(V.slice(B,M+1).forEach(y=>{x.predecessors(y).forEach(k=>{let R=x.node(k),E=R.order;(E<H||N<E)&&!(R.dummy&&x.node(y).dummy)&&a(m,k,y)})}),B=M+1,H=N)}),V}return I.length&&I.reduce($),m}function s(x,I){let m={};function $(V,H,B,S,A){let L;r.range(H,B).forEach(M=>{L=V[M],x.node(L).dummy&&x.predecessors(L).forEach(h=>{let N=x.node(h);N.dummy&&(N.order<S||N.order>A)&&a(m,h,L)})})}function z(V,H){let B=-1,S,A=0;return H.forEach((L,M)=>{if(x.node(L).dummy==="border"){let h=x.predecessors(L);h.length&&(S=x.node(h[0]).order,$(H,A,M,B,S),A=M,B=S)}$(H,A,H.length,S,V.length)}),H}return I.length&&I.reduce(z),m}function i(x,I){if(x.node(I).dummy)return x.predecessors(I).find(m=>x.node(m).dummy)}function a(x,I,m){if(I>m){let z=I;I=m,m=z}let $=x[I];$||(x[I]=$={}),$[m]=!0}function c(x,I,m){if(I>m){let $=I;I=m,m=$}return!!x[I]&&Object.hasOwn(x[I],m)}function u(x,I,m,$){let z={},V={},H={};return I.forEach(B=>{B.forEach((S,A)=>{z[S]=S,V[S]=S,H[S]=A})}),I.forEach(B=>{let S=-1;B.forEach(A=>{let L=$(A);if(L.length){L=L.sort((h,N)=>H[h]-H[N]);let M=(L.length-1)/2;for(let h=Math.floor(M),N=Math.ceil(M);h<=N;++h){let y=L[h];V[A]===A&&S<H[y]&&!c(m,A,y)&&(V[y]=A,V[A]=z[A]=z[y],S=H[y])}}})}),{root:z,align:V}}function l(x,I,m,$,z){let V={},H=d(x,I,m,z),B=z?"borderLeft":"borderRight";function S(M,h){let N=H.nodes().slice(),y={},k=N.pop();for(;k;){if(y[k])M(k);else{y[k]=!0,N.push(k);for(let R of h(k))N.push(R)}k=N.pop()}}function A(M){V[M]=H.inEdges(M).reduce((h,N)=>Math.max(h,V[N.v]+H.edge(N)),0)}function L(M){let h=H.outEdges(M).reduce((y,k)=>Math.min(y,V[k.w]-H.edge(k)),Number.POSITIVE_INFINITY),N=x.node(M);h!==Number.POSITIVE_INFINITY&&N.borderType!==B&&(V[M]=Math.max(V[M],h))}return S(A,H.predecessors.bind(H)),S(L,H.successors.bind(H)),Object.keys($).forEach(M=>V[M]=V[m[M]]),V}function d(x,I,m,$){let z=new n,V=x.graph(),H=C(V.nodesep,V.edgesep,$);return I.forEach(B=>{let S;B.forEach(A=>{let L=m[A];if(z.setNode(L),S){var M=m[S],h=z.edge(M,L);z.setEdge(M,L,Math.max(H(x,A,S),h||0))}S=A})}),z}function g(x,I){return Object.values(I).reduce((m,$)=>{let z=Number.NEGATIVE_INFINITY,V=Number.POSITIVE_INFINITY;Object.entries($).forEach(([B,S])=>{let A=_(x,B)/2;z=Math.max(S+A,z),V=Math.min(S-A,V)});let H=z-V;return H<m[0]&&(m=[H,$]),m},[Number.POSITIVE_INFINITY,null])[1]}function f(x,I){let m=Object.values(I),$=r.applyWithChunking(Math.min,m),z=r.applyWithChunking(Math.max,m);["u","d"].forEach(V=>{["l","r"].forEach(H=>{let B=V+H,S=x[B];if(S===I)return;let A=Object.values(S),L=$-r.applyWithChunking(Math.min,A);H!=="l"&&(L=z-r.applyWithChunking(Math.max,A)),L&&(x[B]=r.mapValues(S,M=>M+L))})})}function v(x,I){return r.mapValues(x.ul,(m,$)=>{if(I)return x[I.toLowerCase()][$];{let z=Object.values(x).map(V=>V[$]).sort((V,H)=>V-H);return(z[1]+z[2])/2}})}function w(x){let I=r.buildLayerMatrix(x),m=Object.assign(o(x,I),s(x,I)),$={},z;["u","d"].forEach(H=>{z=H==="u"?I:Object.values(I).reverse(),["l","r"].forEach(B=>{B==="r"&&(z=z.map(M=>Object.values(M).reverse()));let S=(H==="u"?x.predecessors:x.successors).bind(x),A=u(x,z,m,S),L=l(x,z,A.root,A.align,B==="r");B==="r"&&(L=r.mapValues(L,M=>-M)),$[H+B]=L})});let V=g(x,$);return f($,V),v($,x.graph().align)}function C(x,I,m){return($,z,V)=>{let H=$.node(z),B=$.node(V),S=0,A;if(S+=H.width/2,Object.hasOwn(H,"labelpos"))switch(H.labelpos.toLowerCase()){case"l":A=-H.width/2;break;case"r":A=H.width/2;break}if(A&&(S+=m?A:-A),A=0,S+=(H.dummy?I:x)/2,S+=(B.dummy?I:x)/2,S+=B.width/2,Object.hasOwn(B,"labelpos"))switch(B.labelpos.toLowerCase()){case"l":A=B.width/2;break;case"r":A=-B.width/2;break}return A&&(S+=m?A:-A),A=0,S}}function _(x,I){return x.node(I).width}}),yf=oe((e,t)=>{var n=ce(),r=mf().positionX;t.exports=o;function o(i){i=n.asNonCompoundGraph(i),s(i),Object.entries(r(i)).forEach(([a,c])=>i.node(a).x=c)}function s(i){let a=n.buildLayerMatrix(i),c=i.graph().ranksep,u=i.graph().rankalign,l=0;a.forEach(d=>{let g=d.reduce((f,v)=>{let w=i.node(v).height;return f>w?f:w},0);d.forEach(f=>{let v=i.node(f);u==="top"?v.y=l+v.height/2:u==="bottom"?v.y=l+g-v.height/2:v.y=l+g/2}),l+=g+c})}}),vf=oe((e,t)=>{var n=Qd(),r=Jd(),o=tf(),s=ce().normalizeRanks,i=nf(),a=ce().removeEmptyRanks,c=rf(),u=of(),l=sf(),d=pf(),g=yf(),f=ce(),v=be().Graph;t.exports=w;function w(p,T={}){let P=T.debugTiming?f.time:f.notime;return P("layout",()=>{let j=P("  buildLayoutGraph",()=>S(p));return P("  runLayout",()=>C(j,P,T)),P("  updateInputGraph",()=>_(p,j)),j})}function C(p,T,P){T("    makeSpaceForEdgeLabels",()=>A(p)),T("    removeSelfEdges",()=>O(p)),T("    acyclic",()=>n.run(p)),T("    nestingGraph.run",()=>c.run(p)),T("    rank",()=>o(f.asNonCompoundGraph(p))),T("    injectEdgeLabelProxies",()=>L(p)),T("    removeEmptyRanks",()=>a(p)),T("    nestingGraph.cleanup",()=>c.cleanup(p)),T("    normalizeRanks",()=>s(p)),T("    assignRankMinMax",()=>M(p)),T("    removeEdgeLabelProxies",()=>h(p)),T("    normalize.run",()=>r.run(p)),T("    parentDummyChains",()=>i(p)),T("    addBorderSegments",()=>u(p)),T("    order",()=>d(p,P)),T("    insertSelfEdges",()=>D(p)),T("    adjustCoordinateSystem",()=>l.adjust(p)),T("    position",()=>g(p)),T("    positionSelfEdges",()=>F(p)),T("    removeBorderNodes",()=>E(p)),T("    normalize.undo",()=>r.undo(p)),T("    fixupEdgeLabelCoords",()=>k(p)),T("    undoCoordinateSystem",()=>l.undo(p)),T("    translateGraph",()=>N(p)),T("    assignNodeIntersects",()=>y(p)),T("    reversePoints",()=>R(p)),T("    acyclic.undo",()=>n.undo(p))}function _(p,T){p.nodes().forEach(P=>{let j=p.node(P),W=T.node(P);j&&(j.x=W.x,j.y=W.y,j.order=W.order,j.rank=W.rank,T.children(P).length&&(j.width=W.width,j.height=W.height))}),p.edges().forEach(P=>{let j=p.edge(P),W=T.edge(P);j.points=W.points,Object.hasOwn(W,"x")&&(j.x=W.x,j.y=W.y)}),p.graph().width=T.graph().width,p.graph().height=T.graph().height}var x=["nodesep","edgesep","ranksep","marginx","marginy"],I={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb",rankalign:"center"},m=["acyclicer","ranker","rankdir","align","rankalign"],$=["width","height","rank"],z={width:0,height:0},V=["minlen","weight","width","height","labeloffset"],H={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},B=["labelpos"];function S(p){let T=new v({multigraph:!0,compound:!0}),P=b(p.graph());return T.setGraph(Object.assign({},I,G(P,x),f.pick(P,m))),p.nodes().forEach(j=>{let W=b(p.node(j)),U=G(W,$);Object.keys(z).forEach(Z=>{U[Z]===void 0&&(U[Z]=z[Z])}),T.setNode(j,U),T.setParent(j,p.parent(j))}),p.edges().forEach(j=>{let W=b(p.edge(j));T.setEdge(j,Object.assign({},H,G(W,V),f.pick(W,B)))}),T}function A(p){let T=p.graph();T.ranksep/=2,p.edges().forEach(P=>{let j=p.edge(P);j.minlen*=2,j.labelpos.toLowerCase()!=="c"&&(T.rankdir==="TB"||T.rankdir==="BT"?j.width+=j.labeloffset:j.height+=j.labeloffset)})}function L(p){p.edges().forEach(T=>{let P=p.edge(T);if(P.width&&P.height){let j=p.node(T.v),W={rank:(p.node(T.w).rank-j.rank)/2+j.rank,e:T};f.addDummyNode(p,"edge-proxy",W,"_ep")}})}function M(p){let T=0;p.nodes().forEach(P=>{let j=p.node(P);j.borderTop&&(j.minRank=p.node(j.borderTop).rank,j.maxRank=p.node(j.borderBottom).rank,T=Math.max(T,j.maxRank))}),p.graph().maxRank=T}function h(p){p.nodes().forEach(T=>{let P=p.node(T);P.dummy==="edge-proxy"&&(p.edge(P.e).labelRank=P.rank,p.removeNode(T))})}function N(p){let T=Number.POSITIVE_INFINITY,P=0,j=Number.POSITIVE_INFINITY,W=0,U=p.graph(),Z=U.marginx||0,J=U.marginy||0;function ae(re){let te=re.x,le=re.y,ne=re.width,q=re.height;T=Math.min(T,te-ne/2),P=Math.max(P,te+ne/2),j=Math.min(j,le-q/2),W=Math.max(W,le+q/2)}p.nodes().forEach(re=>ae(p.node(re))),p.edges().forEach(re=>{let te=p.edge(re);Object.hasOwn(te,"x")&&ae(te)}),T-=Z,j-=J,p.nodes().forEach(re=>{let te=p.node(re);te.x-=T,te.y-=j}),p.edges().forEach(re=>{let te=p.edge(re);te.points.forEach(le=>{le.x-=T,le.y-=j}),Object.hasOwn(te,"x")&&(te.x-=T),Object.hasOwn(te,"y")&&(te.y-=j)}),U.width=P-T+Z,U.height=W-j+J}function y(p){p.edges().forEach(T=>{let P=p.edge(T),j=p.node(T.v),W=p.node(T.w),U,Z;P.points?(U=P.points[0],Z=P.points[P.points.length-1]):(P.points=[],U=W,Z=j),P.points.unshift(f.intersectRect(j,U)),P.points.push(f.intersectRect(W,Z))})}function k(p){p.edges().forEach(T=>{let P=p.edge(T);if(Object.hasOwn(P,"x"))switch((P.labelpos==="l"||P.labelpos==="r")&&(P.width-=P.labeloffset),P.labelpos){case"l":P.x-=P.width/2+P.labeloffset;break;case"r":P.x+=P.width/2+P.labeloffset;break}})}function R(p){p.edges().forEach(T=>{let P=p.edge(T);P.reversed&&P.points.reverse()})}function E(p){p.nodes().forEach(T=>{if(p.children(T).length){let P=p.node(T),j=p.node(P.borderTop),W=p.node(P.borderBottom),U=p.node(P.borderLeft[P.borderLeft.length-1]),Z=p.node(P.borderRight[P.borderRight.length-1]);P.width=Math.abs(Z.x-U.x),P.height=Math.abs(W.y-j.y),P.x=U.x+P.width/2,P.y=j.y+P.height/2}}),p.nodes().forEach(T=>{p.node(T).dummy==="border"&&p.removeNode(T)})}function O(p){p.edges().forEach(T=>{if(T.v===T.w){var P=p.node(T.v);P.selfEdges||(P.selfEdges=[]),P.selfEdges.push({e:T,label:p.edge(T)}),p.removeEdge(T)}})}function D(p){var T=f.buildLayerMatrix(p);T.forEach(P=>{var j=0;P.forEach((W,U)=>{var Z=p.node(W);Z.order=U+j,(Z.selfEdges||[]).forEach(J=>{f.addDummyNode(p,"selfedge",{width:J.label.width,height:J.label.height,rank:Z.rank,order:U+ ++j,e:J.e,label:J.label},"_se")}),delete Z.selfEdges})})}function F(p){p.nodes().forEach(T=>{var P=p.node(T);if(P.dummy==="selfedge"){var j=p.node(P.e.v),W=j.x+j.width/2,U=j.y,Z=P.x-W,J=j.height/2;p.setEdge(P.e,P.label),p.removeNode(T),P.label.points=[{x:W+2*Z/3,y:U-J},{x:W+5*Z/6,y:U-J},{x:W+Z,y:U},{x:W+5*Z/6,y:U+J},{x:W+2*Z/3,y:U+J}],P.label.x=P.x,P.label.y=P.y}})}function G(p,T){return f.mapValues(f.pick(p,T),Number)}function b(p){var T={};return p&&Object.entries(p).forEach(([P,j])=>{typeof P=="string"&&(P=P.toLowerCase()),T[P]=j}),T}}),wf=oe((e,t)=>{var n=ce(),r=be().Graph;t.exports={debugOrdering:o};function o(s){let i=n.buildLayerMatrix(s),a=new r({compound:!0,multigraph:!0}).setGraph({});return s.nodes().forEach(c=>{a.setNode(c,{label:c}),a.setParent(c,"layer"+s.node(c).rank)}),s.edges().forEach(c=>a.setEdge(c.v,c.w,{},c.name)),i.forEach((c,u)=>{let l="layer"+u;a.setNode(l,{rank:"same"}),c.reduce((d,g)=>(a.setEdge(d,g,{style:"invis"}),g))}),a}}),xf=oe((e,t)=>{t.exports="2.0.4"}),bf=oe((e,t)=>{t.exports={graphlib:be(),layout:vf(),debug:wf(),util:{time:ce().time,notime:ce().notime},version:xf()}});const Pr=bf();/*! For license information please see dagre.esm.js.LEGAL.txt */function Ft(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()).replace(/\bAi\b/g,"AI").replace(/\bEu\b/g,"EU").replace(/\bCo2\b/g,"CO")}function St(e){if(!e)return"";switch(e.type){case"NumberLiteral":return Lr(e.value);case"PercentageLiteral":return`${e.value}%`;case"CurrencyLiteral":{const t=e,n=t.magnitude??"";return`${Lr(t.value/Ef(n))}${n} ${t.currency}`}case"StringLiteral":return e.value;case"BooleanLiteral":return e.value?"Yes":"No";default:return""}}function Ef(e){switch(e){case"K":return 1e3;case"M":return 1e6;case"B":return 1e9;case"T":return 1e12;default:return 1}}function Lr(e){return Math.abs(e)>=1e9?`${(e/1e9).toFixed(1)}B`:Math.abs(e)>=1e6?`${(e/1e6).toFixed(1)}M`:Number.isInteger(e)?e.toLocaleString("en-US"):e.toFixed(2)}function Vr(e){return e?e.distribution==="normal"&&e.params.length===1?`${St(e.params[0])}`:{normal:"Normal",beta:"Skewed",uniform:"Uniform",triangular:"Triangular",lognormal:"Log-normal"}[e.distribution]??e.distribution:""}function _f(e){return e?{linear:"Linear",logistic:"S-curve",exponential:"Exponential",sigmoid:"S-curve"}[e.model]??e.model:""}function ft({color:e,icon:t,typeLabel:n,name:r,selected:o,children:s,hasInput:i=!1,hasOutput:a=!1}){return Q.jsxs("div",{className:`rounded-xl overflow-hidden transition-all min-w-[200px] max-w-[240px] ${o?"ring-2 ring-white/30 shadow-xl scale-[1.03]":"shadow-lg"}`,style:{background:"linear-gradient(145deg, rgba(30,41,59,0.95), rgba(15,23,42,0.95))",border:`1px solid ${o?e:"rgba(51,65,85,0.6)"}`},children:[Q.jsx("div",{className:"h-1",style:{background:e}}),Q.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 pt-1.5 pb-0.5",children:[Q.jsx("span",{className:"text-xs",children:t}),Q.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-widest opacity-60",style:{color:e},children:n})]}),Q.jsx("div",{className:"px-2.5 pb-0.5",children:Q.jsx("p",{className:"text-[11px] font-semibold text-white leading-tight truncate",children:r})}),Q.jsx("div",{className:"px-2.5 pb-2.5 space-y-0.5",children:s}),i&&Q.jsx(dt,{type:"target",position:K.Left,className:"!w-2.5 !h-2.5 !rounded-full !border-2 !-left-1",style:{borderColor:e,background:"#0f172a"}}),a&&Q.jsx(dt,{type:"source",position:K.Right,className:"!w-2.5 !h-2.5 !rounded-full !border-2 !-right-1",style:{borderColor:e,background:"#0f172a"}})]})}function Jt({text:e,cls:t="bg-slate-700/60 text-slate-400"}){return e?Q.jsx("span",{className:`inline-block text-[8px] font-medium px-1 py-0.5 rounded ${t}`,children:e}):null}const Nf=Y.memo(({data:e,selected:t})=>Q.jsxs(ft,{color:"#3b82f6",icon:"",typeLabel:"Assumption",name:e.label,selected:t,hasOutput:!0,children:[e.value&&e.value!==""&&Q.jsxs("div",{className:"flex items-baseline gap-1.5",children:[Q.jsx("span",{className:"text-sm font-bold text-blue-300 font-mono",children:e.value}),e.uncertainty&&Q.jsx("span",{className:"text-[9px] text-blue-400/70",children:e.uncertainty})]}),e.confidence!=null&&Q.jsxs("div",{className:"flex items-center gap-1",children:[Q.jsx("div",{className:"flex-1 h-0.5 bg-slate-700/50 rounded-full overflow-hidden",children:Q.jsx("div",{className:"h-full bg-blue-500/60 rounded-full",style:{width:`${e.confidence*100}%`}})}),Q.jsxs("span",{className:"text-[8px] text-slate-500",children:[(e.confidence*100).toFixed(0),"%"]})]})]})),Sf=Y.memo(({data:e,selected:t})=>Q.jsxs(ft,{color:"#06b6d4",icon:"",typeLabel:"Parameter",name:e.label,selected:t,hasOutput:!0,children:[e.value&&e.value!==""&&Q.jsx("span",{className:"text-sm font-bold text-cyan-300 font-mono",children:e.value}),e.description&&Q.jsx("p",{className:"text-[9px] text-slate-500 truncate",children:e.description})]})),kf=Y.memo(({data:e,selected:t})=>Q.jsxs(ft,{color:e.color??"#10b981",icon:"",typeLabel:"Variable",name:e.label,selected:t,hasInput:!0,hasOutput:!0,children:[e.description&&Q.jsx("p",{className:"text-[9px] text-slate-500 truncate",children:e.description}),e.valueRange&&Q.jsxs("div",{className:"flex items-baseline gap-1.5",children:[Q.jsx("span",{className:"text-[10px] text-emerald-300 font-mono font-bold",children:e.valueRange}),e.unit&&Q.jsx("span",{className:"text-[8px] text-slate-500",children:e.unit})]}),Q.jsxs("div",{className:"flex flex-wrap gap-0.5",children:[e.model&&Q.jsx(Jt,{text:e.model,cls:"bg-emerald-500/15 text-emerald-300"}),e.uncertainty&&Q.jsx(Jt,{text:e.uncertainty,cls:"bg-emerald-500/10 text-emerald-400/60"})]})]})),Cf=Y.memo(({data:e,selected:t})=>Q.jsxs(ft,{color:e.color??"#8b5cf6",icon:"",typeLabel:"Impact",name:e.label,selected:t,hasInput:!0,children:[e.description&&Q.jsx("p",{className:"text-[9px] text-slate-500 truncate",children:e.description}),e.unit&&Q.jsx(Jt,{text:e.unit,cls:"bg-violet-500/15 text-violet-300"})]})),Mf=Y.memo(({data:e,selected:t})=>Q.jsx(ft,{color:"#f59e0b",icon:"",typeLabel:"Branch",name:e.label,selected:t,hasInput:!0,hasOutput:!0,children:e.probability!=null&&Q.jsxs("div",{className:"flex items-center gap-1.5",children:[Q.jsx("div",{className:"flex-1 h-1 bg-slate-700/60 rounded-full overflow-hidden",children:Q.jsx("div",{className:"h-full rounded-full bg-amber-500",style:{width:`${Math.min(e.probability*100,100)}%`}})}),Q.jsxs("span",{className:"text-[10px] font-semibold text-amber-300",children:[(e.probability*100).toFixed(0),"%"]})]})})),If=Y.memo(({data:e,selected:t})=>Q.jsx(ft,{color:"#64748b",icon:"",typeLabel:"Simulate",name:"Monte Carlo",selected:t,children:Q.jsx(Jt,{text:"2,000 runs"})})),Af={"sdl-assumption":Nf,"sdl-variable":kf,"sdl-parameter":Sf,"sdl-impact":Cf,"sdl-branch":Mf,"sdl-simulate":If},Fr=240,Hr=90;function Tf(e){var t,n;switch(e.type){case"Assumption":{const r=e;return{label:Ft(r.name),value:St(r.value),confidence:r.confidence,uncertainty:Vr(r.uncertainty),color:"#3b82f6"}}case"Variable":{const r=e,o=(t=r.timeseries)==null?void 0:t[0],s=(n=r.timeseries)==null?void 0:n[r.timeseries.length-1],i=o?St(o.value):"",a=s?St(s.value):"";return{label:r.label??Ft(r.name),description:r.description,unit:r.unit,model:_f(r.model),uncertainty:Vr(r.uncertainty),valueRange:i&&a?`${i}  ${a}`:"",color:r.color??"#10b981"}}case"Parameter":{const r=e;return{label:r.label??Ft(r.name),value:St(r.value),description:r.description,color:r.color??"#06b6d4"}}case"Impact":{const r=e;return{label:r.label??Ft(r.name),description:r.description,unit:r.unit,color:r.color??"#8b5cf6"}}case"Branch":{const r=e;return{label:r.name,probability:r.probability,color:"#f59e0b"}}case"Simulate":return{label:"Simulation",color:"#64748b"};default:return{label:e.name??e.type,color:"#64748b"}}}function $f(e,t){const n=[],r=[],o=new Set;for(const i of e.declarations){const a=i.type==="Branch"?i.name:i.type==="Simulate"?"__simulate__":i.name;!a||o.has(a)||(o.add(a),n.push({id:a,type:`sdl-${i.type.toLowerCase()}`,data:Tf(i),position:{x:0,y:0}}))}if(t)for(const i of t.edges)n.some(a=>a.id===i.from)&&n.some(a=>a.id===i.to)&&r.push({id:`e-${i.from}-${i.to}`,source:i.from,target:i.to,animated:!0,style:{stroke:"rgba(100,116,139,0.5)",strokeWidth:1.5},type:"smoothstep"});const s=new Pr.graphlib.Graph;s.setDefaultEdgeLabel(()=>({})),s.setGraph({rankdir:"LR",ranksep:120,nodesep:50,marginx:60,marginy:60});for(const i of n)s.setNode(i.id,{width:Fr,height:Hr});for(const i of r)s.setEdge(i.source,i.target);Pr.layout(s);for(const i of n){const a=s.node(i.id);a&&(i.position={x:a.x-Fr/2,y:a.y-Hr/2})}return{nodes:n,edges:r}}function Rf({sdlSource:e}){const t=Y.useMemo(()=>{try{const{ast:i}=Ki(e);if(!i)return null;const a=Qi(i);return $f(i,a.causalGraph??void 0)}catch{return null}},[e]),[n,,r]=Sd((t==null?void 0:t.nodes)??[]),[o,,s]=kd((t==null?void 0:t.edges)??[]);return!t||n.length===0?Q.jsx("div",{className:"h-[500px] flex items-center justify-center text-slate-500 text-sm",children:"Impossibile generare il grafo causale"}):Q.jsx("div",{className:"h-[500px] rounded-xl overflow-hidden border border-slate-800",children:Q.jsxs(li,{nodes:n,edges:o,onNodesChange:r,onEdgesChange:s,nodeTypes:Af,fitView:!0,fitViewOptions:{padding:.3,minZoom:.4,maxZoom:1.2},minZoom:.2,maxZoom:2,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"rgb(71,85,105)",strokeWidth:2}},proOptions:{hideAttribution:!0},children:[Q.jsx(Zd,{variant:ve.Dots,gap:24,size:1,color:"rgb(30,41,59)"}),Q.jsx(jd,{showInteractive:!1,position:"bottom-left"}),Q.jsx(Dd,{nodeStrokeWidth:3,nodeColor:i=>{var a;return((a=i.data)==null?void 0:a.color)??"#64748b"},maskColor:"rgba(15,23,42,0.8)",position:"bottom-right",style:{width:130,height:85}})]})})}export{Rf as default};
